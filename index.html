<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mana Delivery - Telangana's Complete Service Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            box-sizing: border-box;
        }
        
        .bg-primary { background-color: #FEFAE0; }
        .bg-secondary { background-color: #606C38; }
        .bg-accent { background-color: #283618; }
        .text-secondary { color: #606C38; }
        .text-accent { color: #283618; }
        .border-secondary { border-color: #606C38; }
        
        .carousel-container {
            overflow: hidden;
            position: relative;
        }
        
        .carousel-track {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }
        
        .carousel-slide {
            min-width: 100%;
            flex-shrink: 0;
        }
        
        .grid-card {
            transition: all 0.3s ease;
        }
        
        .grid-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 50;
        }
        
        .page-content {
            padding-bottom: 80px;
        }
        
        .quantity-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
        }
        
        .location-warning {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            color: white;
            padding: 12px;
            border-radius: 8px;
            margin: 16px;
            text-align: center;
            font-weight: bold;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            backdrop-filter: blur(5px);
            padding: 20px;
            box-sizing: border-box;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
            pointer-events: none;
        }
        
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 1;
            visibility: visible;
            pointer-events: all;
        }
        
        .modal.closing {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }
        
        .modal.active ~ * {
            pointer-events: none;
        }
        
        body.modal-open {
            overflow: hidden !important;
            position: fixed;
            width: 100%;
            height: 100%;
        }
        
        .location-popup {
            background: linear-gradient(135deg, #ff6b6b, #ffa500);
            color: white;
            padding: 24px;
            border-radius: 16px;
            text-align: center;
            max-width: 320px;
            width: 100%;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            animation: popupSlide 0.3s ease-out;
        }
        
        @keyframes popupSlide {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #606C38;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        /* Hide scrollbar for webkit browsers */
        .overflow-x-auto::-webkit-scrollbar {
            display: none;
        }

        /* Welcome Popup Styles */
        .welcome-popup {
            background: linear-gradient(135deg, #606C38, #283618);
            color: white;
            padding: 32px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
            width: 100%;
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
            animation: welcomeSlide 0.6s ease-out;
            position: relative;
            overflow: hidden;
        }

        .welcome-popup::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes welcomeSlide {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        /* Info Popup Styles */
        .info-popup {
            background: white;
            padding: 24px;
            border-radius: 16px;
            text-align: center;
            max-width: 350px;
            width: 100%;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            animation: infoSlide 0.4s ease-out;
            border-top: 4px solid #606C38;
        }

        @keyframes infoSlide {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Page Transition Styles */
        .page {
            transition: all 0.3s ease-in-out;
        }

        .page.hidden {
            opacity: 0;
            transform: translateX(20px);
        }

        .page:not(.hidden) {
            opacity: 1;
            transform: translateX(0);
        }

        /* Button Hover Effects */
        .grid-card, .service-card, .event-card, .business-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .grid-card:hover, .service-card:hover, .event-card:hover, .business-card:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 12px 30px rgba(0,0,0,0.2);
        }

        /* Navigation Transition */
        .nav-item {
            transition: all 0.3s ease;
        }

        .nav-item:hover {
            transform: translateY(-2px);
        }



        /* Loading Animation */
        .loading-dots {
            display: inline-block;
        }

        .loading-dots::after {
            content: '';
            animation: dots 1.5s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }

        /* Pulse Animation for Important Elements */
        .pulse-glow {
            animation: pulseGlow 2s ease-in-out infinite alternate;
        }

        @keyframes pulseGlow {
            from {
                box-shadow: 0 0 5px rgba(96, 108, 56, 0.5);
            }
            to {
                box-shadow: 0 0 20px rgba(96, 108, 56, 0.8), 0 0 30px rgba(96, 108, 56, 0.4);
            }
        }

        /* Smooth Scroll */
        html {
            scroll-behavior: smooth;
        }

        /* Feature Highlight */
        .feature-highlight {
            position: relative;
            overflow: hidden;
        }

        .feature-highlight::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .feature-highlight:hover::after {
            left: 100%;
        }
    </style>
</head>
<body class="bg-primary">


    <!-- Header -->
    <header class="bg-secondary text-white p-4 shadow-lg">
        <div class="flex justify-between items-center">
            <div class="flex items-center gap-3">
                <img src="https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=50&h=50&fit=crop&crop=center" alt="Mana Delivery Logo" class="w-10 h-10 rounded-full object-cover border-2 border-white shadow-md">
                <div>
                    <h1 class="text-xl font-bold">Mana Delivery</h1>
                    <button onclick="showLocationSelector()" id="locationSelector" class="text-xs bg-white bg-opacity-20 px-2 py-1 rounded-full hover:bg-opacity-30 transition-colors">
                        <i class="fas fa-map-marker-alt mr-1"></i>
                        <span id="selectedLocationName">Select Location</span>
                        <i class="fas fa-chevron-down ml-1"></i>
                    </button>
                </div>
            </div>
            <div class="flex gap-2">
                <button onclick="toggleWishlist()" class="relative bg-pink-500 text-white p-2 rounded-full hover:bg-pink-600 transition-colors" style="display: none;" id="headerWishlistBtn">
                    <i class="fas fa-heart text-lg"></i>
                    <span class="absolute -top-1 -right-1 bg-white text-pink-500 text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center shadow-md" id="headerWishlistCount">0</span>
                </button>
                <button onclick="toggleCart()" class="relative bg-green-500 text-white p-2 rounded-full hover:bg-green-600 transition-colors" style="display: none;" id="headerCartBtn">
                    <i class="fas fa-shopping-cart text-lg"></i>
                    <span class="absolute -top-1 -right-1 bg-white text-green-500 text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center shadow-md" id="headerCartCount">0</span>
                </button>
                <button onclick="requestLocationPermission()" id="locationBtn" class="bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition-colors relative" title="Click to enable location">
                    <i class="fas fa-crosshairs text-lg"></i>
                    <div id="locationAccuracy" class="absolute -bottom-1 -right-1 bg-white text-red-500 text-xs font-bold rounded-full w-4 h-4 flex items-center justify-center shadow-md" style="display: none;">
                        <i class="fas fa-signal text-xs"></i>
                    </div>
                </button>
                <a href="tel:7799086877" id="callBtn" class="bg-white text-secondary p-2 rounded-full hover:bg-gray-100 transition-colors">
                    <i class="fas fa-phone text-lg"></i>
                </a>
                <a href="https://wa.me/917799086877" id="whatsappBtn" target="_blank" rel="noopener noreferrer" class="bg-green-500 text-white p-2 rounded-full hover:bg-green-600 transition-colors">
                    <i class="fab fa-whatsapp text-lg"></i>
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="page-content" id="mainContent">
        <!-- Home Page -->
        <div id="homePage" class="page">
            <!-- Image Carousel -->
            <div class="carousel-container mx-4 mt-4 rounded-xl overflow-hidden shadow-lg">
                <div class="carousel-track" id="carouselTrack">
                    <div class="carousel-slide">
                        <img src="https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=800&h=300&fit=crop" alt="Fresh Groceries" class="w-full h-48 object-cover">
                    </div>
                    <div class="carousel-slide">
                        <img src="https://images.unsplash.com/photo-1544620347-c4fd4a3d5957?w=800&h=300&fit=crop" alt="Transportation" class="w-full h-48 object-cover">
                    </div>
                    <div class="carousel-slide">
                        <img src="https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=800&h=300&fit=crop" alt="Services" class="w-full h-48 object-cover">
                    </div>
                    <div class="carousel-slide">
                        <img src="https://images.unsplash.com/photo-1511795409834-ef04bbd61622?w=800&h=300&fit=crop" alt="Events" class="w-full h-48 object-cover">
                    </div>
                    <div class="carousel-slide">
                        <img src="https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=800&h=300&fit=crop" alt="Business Support" class="w-full h-48 object-cover">
                    </div>
                </div>
            </div>

            <!-- Service Categories Grid -->
            <div class="p-4">
                <h2 class="text-xl font-bold text-accent mb-4">Our Services</h2>
                <div class="grid grid-cols-2 gap-4">
                    <div class="grid-card bg-white rounded-xl p-4 shadow-md cursor-pointer" onclick="showPage('storePage')">
                        <img src="https://images.unsplash.com/photo-1542838132-92c53300491e?w=200&h=120&fit=crop" alt="Store" class="w-full h-20 object-cover rounded-lg mb-2">
                        <h3 class="font-semibold text-accent">Store</h3>
                        <p class="text-sm text-gray-600">Groceries & Essentials</p>
                    </div>
                    <div class="grid-card bg-white rounded-xl p-4 shadow-md cursor-pointer" onclick="showPage('transportPage')">
                        <img src="https://images.unsplash.com/photo-1449824913935-59a10b8d2000?w=200&h=120&fit=crop" alt="Transport" class="w-full h-20 object-cover rounded-lg mb-2">
                        <h3 class="font-semibold text-accent">Transport</h3>
                        <p class="text-sm text-gray-600">Local & Tours</p>
                    </div>
                    <div class="grid-card bg-white rounded-xl p-4 shadow-md cursor-pointer" onclick="showPage('servicesPage')">
                        <img src="https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=200&h=120&fit=crop" alt="Services" class="w-full h-20 object-cover rounded-lg mb-2">
                        <h3 class="font-semibold text-accent">Services</h3>
                        <p class="text-sm text-gray-600">Professional Help</p>
                    </div>
                    <div class="grid-card bg-white rounded-xl p-4 shadow-md cursor-pointer" onclick="showPage('eventsPage')">
                        <img src="https://images.unsplash.com/photo-1511795409834-ef04bbd61622?w=200&h=120&fit=crop" alt="Events" class="w-full h-20 object-cover rounded-lg mb-2">
                        <h3 class="font-semibold text-accent">Events</h3>
                        <p class="text-sm text-gray-600">Event Management</p>
                    </div>
                    <div class="grid-card bg-white rounded-xl p-4 shadow-md cursor-pointer" onclick="showPage('businessPage')">
                        <img src="https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=200&h=120&fit=crop" alt="Business" class="w-full h-20 object-cover rounded-lg mb-2">
                        <h3 class="font-semibold text-accent">Business</h3>
                        <p class="text-sm text-gray-600">Support Services</p>
                    </div>
                    <div class="grid-card bg-white rounded-xl p-4 shadow-md cursor-pointer" onclick="showPage('joinPage')">
                        <img src="https://images.unsplash.com/photo-1521737604893-d14cc237f11d?w=200&h=120&fit=crop" alt="Join Us" class="w-full h-20 object-cover rounded-lg mb-2">
                        <h3 class="font-semibold text-accent">Join Us</h3>
                        <p class="text-sm text-gray-600">Partners & Vendors</p>
                    </div>
                </div>
            </div>

            <!-- Banner -->
            <div class="mx-4 my-6">
                <img src="https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=800&h=200&fit=crop" alt="Special Offers" class="w-full h-32 object-cover rounded-xl shadow-md">
            </div>

            <!-- Featured Products -->
            <div class="p-4">
                <h2 class="text-xl font-bold text-accent mb-4">Featured Products</h2>
                <div class="flex gap-3 overflow-x-auto pb-2" style="scrollbar-width: none; -ms-overflow-style: none;">
                    <div class="bg-white rounded-xl p-2 shadow-md cursor-pointer flex-shrink-0 w-24" onclick="showPage('storePage'); showCategory('vegetables');">
                        <img src="https://images.unsplash.com/photo-1506617420156-8e4536971650?w=100&h=60&fit=crop" alt="Fresh Vegetables" class="w-full h-12 object-cover rounded-lg mb-1">
                        <h4 class="font-semibold text-xs">Fresh Vegetables</h4>
                        <p class="text-xs text-secondary">Today's price</p>
                    </div>
                    <div class="bg-white rounded-xl p-2 shadow-md cursor-pointer flex-shrink-0 w-24" onclick="showPage('storePage'); showCategory('dairy');">
                        <img src="https://images.unsplash.com/photo-1563636619-e9143da7973b?w=100&h=60&fit=crop" alt="Dairy Products" class="w-full h-12 object-cover rounded-lg mb-1">
                        <h4 class="font-semibold text-xs">Dairy Products</h4>
                        <p class="text-xs text-secondary">Today's price</p>
                    </div>
                    <div class="bg-white rounded-xl p-2 shadow-md cursor-pointer flex-shrink-0 w-24" onclick="showPage('storePage'); showCategory('fruits');">
                        <img src="https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=100&h=60&fit=crop" alt="Fresh Fruits" class="w-full h-12 object-cover rounded-lg mb-1">
                        <h4 class="font-semibold text-xs">Fresh Fruits</h4>
                        <p class="text-xs text-secondary">Today's price</p>
                    </div>
                    <div class="bg-white rounded-xl p-2 shadow-md cursor-pointer flex-shrink-0 w-24" onclick="showPage('storePage'); showCategory('grains');">
                        <img src="https://images.unsplash.com/photo-1574323347407-f5e1ad6d020b?w=100&h=60&fit=crop" alt="Rice & Grains" class="w-full h-12 object-cover rounded-lg mb-1">
                        <h4 class="font-semibold text-xs">Rice & Grains</h4>
                        <p class="text-xs text-secondary">Today's price</p>
                    </div>
                    <div class="bg-white rounded-xl p-2 shadow-md cursor-pointer flex-shrink-0 w-24" onclick="showPage('storePage'); showCategory('spices');">
                        <img src="https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=100&h=60&fit=crop" alt="Spices" class="w-full h-12 object-cover rounded-lg mb-1">
                        <h4 class="font-semibold text-xs">Spices</h4>
                        <p class="text-xs text-secondary">Today's price</p>
                    </div>
                    <div class="bg-white rounded-xl p-2 shadow-md cursor-pointer flex-shrink-0 w-24" onclick="showPage('storePage'); showCategory('snacks');">
                        <img src="https://images.unsplash.com/photo-1621939514649-280e2ee25f60?w=100&h=60&fit=crop" alt="Snacks" class="w-full h-12 object-cover rounded-lg mb-1">
                        <h4 class="font-semibold text-xs">Snacks</h4>
                        <p class="text-xs text-secondary">Today's price</p>
                    </div>
                    <div class="bg-white rounded-xl p-2 shadow-md cursor-pointer flex-shrink-0 w-24" onclick="showPage('storePage'); showCategory('vegetables');">
                        <img src="https://images.unsplash.com/photo-1518977676601-b53f82aba655?w=100&h=60&fit=crop" alt="Potatoes" class="w-full h-12 object-cover rounded-lg mb-1">
                        <h4 class="font-semibold text-xs">Potatoes</h4>
                        <p class="text-xs text-secondary">Today's price</p>
                    </div>
                    <div class="bg-white rounded-xl p-2 shadow-md cursor-pointer flex-shrink-0 w-24" onclick="showPage('storePage'); showCategory('fruits');">
                        <img src="https://images.unsplash.com/photo-1560806887-1e4cd0b6cbd6?w=100&h=60&fit=crop" alt="Apples" class="w-full h-12 object-cover rounded-lg mb-1">
                        <h4 class="font-semibold text-xs">Apples</h4>
                        <p class="text-xs text-secondary">Today's price</p>
                    </div>
                </div>
            </div>

            <!-- Quick Bookings -->
            <div class="p-4">
                <h2 class="text-xl font-bold text-accent mb-4">Quick Bookings</h2>
                <div class="space-y-3">
                    <button onclick="openQuickTransport()" class="w-full bg-secondary text-white p-4 rounded-xl flex items-center justify-between hover:bg-opacity-90 transition-colors">
                        <div class="flex items-center gap-3">
                            <i class="fas fa-car text-xl"></i>
                            <span class="font-semibold">Local Transport</span>
                        </div>
                        <i class="fas fa-arrow-right"></i>
                    </button>
                    <button onclick="openQuickHomeDelivery()" class="w-full bg-green-600 text-white p-4 rounded-xl flex items-center justify-between hover:bg-opacity-90 transition-colors">
                        <div class="flex items-center gap-3">
                            <i class="fas fa-home text-xl"></i>
                            <span class="font-semibold">Home Delivery</span>
                        </div>
                        <i class="fas fa-arrow-right"></i>
                    </button>
                    <button onclick="openQuickDelivery()" class="w-full bg-accent text-white p-4 rounded-xl flex items-center justify-between hover:bg-opacity-90 transition-colors">
                        <div class="flex items-center gap-3">
                            <i class="fas fa-box text-xl"></i>
                            <span class="font-semibold">Parcel Delivery</span>
                        </div>
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>

            <!-- Special Offers Banner Carousel -->
            <div class="p-4">
                <div class="carousel-container rounded-xl overflow-hidden shadow-lg mb-6">
                    <div class="carousel-track" id="offersCarouselTrack">
                        <div class="carousel-slide">
                            <img src="https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?w=800&h=200&fit=crop" alt="Special Offers" class="w-full h-40 object-cover">
                        </div>
                        <div class="carousel-slide">
                            <img src="https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=800&h=200&fit=crop" alt="Weekend Deals" class="w-full h-40 object-cover">
                        </div>
                        <div class="carousel-slide">
                            <img src="https://images.unsplash.com/photo-1607082349566-187342175e2f?w=800&h=200&fit=crop" alt="Service Discounts" class="w-full h-40 object-cover">
                        </div>
                    </div>
                    <div class="flex justify-center py-3 space-x-2">
                        <button class="offers-dot w-2 h-2 rounded-full bg-secondary shadow-md transition-all duration-300 hover:scale-110" onclick="goToOfferSlide(0)"></button>
                        <button class="offers-dot w-2 h-2 rounded-full bg-gray-400 shadow-md transition-all duration-300 hover:scale-110" onclick="goToOfferSlide(1)"></button>
                        <button class="offers-dot w-2 h-2 rounded-full bg-gray-400 shadow-md transition-all duration-300 hover:scale-110" onclick="goToOfferSlide(2)"></button>
                    </div>
                </div>
            </div>

            <!-- Top Services -->
            <div class="p-4">
                <h2 class="text-xl font-bold text-accent mb-4">Top Services</h2>
                <div class="grid grid-cols-3 gap-3">
                    <div class="bg-white rounded-lg p-3 text-center shadow-md cursor-pointer hover:shadow-lg transition-shadow" onclick="showPage('servicesPage'); bookService('plumber');">
                        <i class="fas fa-wrench text-2xl text-secondary mb-2"></i>
                        <p class="text-xs font-semibold">Plumber</p>
                    </div>
                    <div class="bg-white rounded-lg p-3 text-center shadow-md cursor-pointer hover:shadow-lg transition-shadow" onclick="showPage('servicesPage'); bookService('painter');">
                        <i class="fas fa-paint-brush text-2xl text-secondary mb-2"></i>
                        <p class="text-xs font-semibold">Painter</p>
                    </div>
                    <div class="bg-white rounded-lg p-3 text-center shadow-md cursor-pointer hover:shadow-lg transition-shadow" onclick="showPage('servicesPage'); bookService('barber');">
                        <i class="fas fa-cut text-2xl text-secondary mb-2"></i>
                        <p class="text-xs font-semibold">Barber</p>
                    </div>
                    <div class="bg-white rounded-lg p-3 text-center shadow-md cursor-pointer hover:shadow-lg transition-shadow" onclick="showPage('servicesPage'); bookService('electrician');">
                        <i class="fas fa-bolt text-2xl text-secondary mb-2"></i>
                        <p class="text-xs font-semibold">Electrician</p>
                    </div>
                    <div class="bg-white rounded-lg p-3 text-center shadow-md cursor-pointer hover:shadow-lg transition-shadow" onclick="showPage('servicesPage'); bookService('cleaner');">
                        <i class="fas fa-broom text-2xl text-secondary mb-2"></i>
                        <p class="text-xs font-semibold">Cleaning</p>
                    </div>
                    <div class="bg-white rounded-lg p-3 text-center shadow-md cursor-pointer hover:shadow-lg transition-shadow" onclick="showPage('servicesPage'); bookService('carpenter');">
                        <i class="fas fa-hammer text-2xl text-secondary mb-2"></i>
                        <p class="text-xs font-semibold">Carpenter</p>
                    </div>
                </div>
            </div>

            <!-- Terms & Policies Section -->
            <div class="p-4">
                <h2 class="text-xl font-bold text-accent mb-4">Terms & Policies</h2>
                <div class="space-y-3">
                    <!-- Terms and Conditions -->
                    <div class="bg-white rounded-xl shadow-md overflow-hidden">
                        <button onclick="togglePolicy('terms')" class="w-full p-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors">
                            <div class="flex items-center gap-3">
                                <i class="fas fa-file-contract text-secondary text-xl"></i>
                                <span class="font-semibold text-accent">Terms & Conditions</span>
                            </div>
                            <i id="terms-icon" class="fas fa-chevron-down text-secondary transition-transform duration-300"></i>
                        </button>
                        <div id="terms-content" class="hidden px-4 pb-4">
                            <div class="text-sm text-gray-700 space-y-3 bg-gray-50 p-4 rounded-lg">
                                <div>
                                    <h4 class="font-semibold text-accent mb-2">1. Service Agreement</h4>
                                    <p>By using Mana Delivery services, you agree to our terms. We provide delivery, transport, and professional services across Telangana with quality assurance.</p>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-accent mb-2">2. User Responsibilities</h4>
                                    <p>Users must provide accurate information, make timely payments, and treat service providers with respect. False information may result in service cancellation.</p>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-accent mb-2">3. Service Availability</h4>
                                    <p>Services are subject to availability and weather conditions. We reserve the right to modify or cancel services with prior notice.</p>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-accent mb-2">4. Payment Terms</h4>
                                    <p>Payment is due upon service completion unless otherwise agreed. We accept cash, UPI, and digital payments as per service provider preference.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Privacy Policy -->
                    <div class="bg-white rounded-xl shadow-md overflow-hidden">
                        <button onclick="togglePolicy('privacy')" class="w-full p-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors">
                            <div class="flex items-center gap-3">
                                <i class="fas fa-shield-alt text-secondary text-xl"></i>
                                <span class="font-semibold text-accent">Privacy Policy</span>
                            </div>
                            <i id="privacy-icon" class="fas fa-chevron-down text-secondary transition-transform duration-300"></i>
                        </button>
                        <div id="privacy-content" class="hidden px-4 pb-4">
                            <div class="text-sm text-gray-700 space-y-3 bg-gray-50 p-4 rounded-lg">
                                <div>
                                    <h4 class="font-semibold text-accent mb-2">1. Information Collection</h4>
                                    <p>We collect name, phone, address, and location data only for service delivery. Your data is encrypted and stored securely.</p>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-accent mb-2">2. Data Usage</h4>
                                    <p>Personal information is used solely for service fulfillment, communication, and improving user experience. We never sell your data to third parties.</p>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-accent mb-2">3. Location Privacy</h4>
                                    <p>Location data is shared only with assigned service providers for accurate delivery/service. Location sharing is optional but recommended.</p>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-accent mb-2">4. Data Security</h4>
                                    <p>We use industry-standard security measures to protect your information. Data is retained only as long as necessary for service provision.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Return & Refund Policy -->
                    <div class="bg-white rounded-xl shadow-md overflow-hidden">
                        <button onclick="togglePolicy('refund')" class="w-full p-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors">
                            <div class="flex items-center gap-3">
                                <i class="fas fa-undo-alt text-secondary text-xl"></i>
                                <span class="font-semibold text-accent">Return & Refund Policy</span>
                            </div>
                            <i id="refund-icon" class="fas fa-chevron-down text-secondary transition-transform duration-300"></i>
                        </button>
                        <div id="refund-content" class="hidden px-4 pb-4">
                            <div class="text-sm text-gray-700 space-y-3 bg-gray-50 p-4 rounded-lg">
                                <div>
                                    <h4 class="font-semibold text-accent mb-2">1. Grocery Returns</h4>
                                    <p>Fresh produce can be returned within 2 hours if damaged or spoiled. Packaged goods can be returned within 24 hours if unopened.</p>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-accent mb-2">2. Service Cancellation</h4>
                                    <p>Services can be cancelled up to 2 hours before scheduled time without charges. Late cancellations may incur 25% of service fee.</p>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-accent mb-2">3. Transport Refunds</h4>
                                    <p>Transport bookings cancelled 1 hour before pickup are fully refundable. No-show charges apply after 15 minutes of scheduled time.</p>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-accent mb-2">4. Quality Guarantee</h4>
                                    <p>If unsatisfied with service quality, report within 24 hours. We offer re-service, partial refund, or service credit based on the issue.</p>
                                </div>
                                <div class="bg-green-100 p-3 rounded-lg mt-3">
                                    <p class="text-green-800 font-semibold text-center">
                                        <i class="fas fa-phone mr-2"></i>
                                        For returns/refunds, call us at 7799086877
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Customer Testimonials -->
            <div class="p-4">
                <h2 class="text-xl font-bold text-accent mb-4">What Our Customers Say</h2>
                <div class="carousel-container rounded-xl overflow-hidden shadow-lg bg-gradient-to-br from-blue-50 to-indigo-100 border border-blue-200">
                    <div class="carousel-track" id="testimonialTrack" style="transition: transform 0.5s ease-in-out;">
                        <div class="carousel-slide p-4 text-center h-48 flex items-center justify-center">
                            <div class="w-full max-w-xs mx-auto">
                                <div class="flex justify-center mb-3">
                                    <i class="fas fa-star text-yellow-500 text-sm"></i>
                                    <i class="fas fa-star text-yellow-500 text-sm"></i>
                                    <i class="fas fa-star text-yellow-500 text-sm"></i>
                                    <i class="fas fa-star text-yellow-500 text-sm"></i>
                                    <i class="fas fa-star text-yellow-500 text-sm"></i>
                                </div>
                                <p class="text-gray-800 text-sm leading-relaxed mb-3 font-medium">"Excellent service! Got fresh vegetables delivered within an hour. Quality was amazing and prices very reasonable."</p>
                                <h4 class="font-bold text-base text-secondary">Rajesh Kumar</h4>
                                <p class="text-xs text-blue-600 font-semibold">Hyderabad</p>
                            </div>
                        </div>
                        <div class="carousel-slide p-4 text-center h-48 flex items-center justify-center">
                            <div class="w-full max-w-xs mx-auto">
                                <div class="flex justify-center mb-3">
                                    <i class="fas fa-star text-yellow-500 text-sm"></i>
                                    <i class="fas fa-star text-yellow-500 text-sm"></i>
                                    <i class="fas fa-star text-yellow-500 text-sm"></i>
                                    <i class="fas fa-star text-yellow-500 text-sm"></i>
                                    <i class="fas fa-star text-yellow-500 text-sm"></i>
                                </div>
                                <p class="text-gray-800 text-sm leading-relaxed mb-3 font-medium">"The plumber service was fantastic! Professional, punctual, and solved my problem quickly. Great support and fair pricing."</p>
                                <h4 class="font-bold text-base text-secondary">Priya Sharma</h4>
                                <p class="text-xs text-blue-600 font-semibold">Warangal</p>
                            </div>
                        </div>
                        <div class="carousel-slide p-4 text-center h-48 flex items-center justify-center">
                            <div class="w-full max-w-xs mx-auto">
                                <div class="flex justify-center mb-3">
                                    <i class="fas fa-star text-yellow-500 text-sm"></i>
                                    <i class="fas fa-star text-yellow-500 text-sm"></i>
                                    <i class="fas fa-star text-yellow-500 text-sm"></i>
                                    <i class="fas fa-star text-yellow-500 text-sm"></i>
                                    <i class="fas fa-star text-yellow-500 text-sm"></i>
                                </div>
                                <p class="text-gray-800 text-sm leading-relaxed mb-3 font-medium">"Amazing transport service! Clean vehicles, courteous drivers, and very reliable. Used for airport pickup and local trips."</p>
                                <h4 class="font-bold text-base text-secondary">Suresh Reddy</h4>
                                <p class="text-xs text-blue-600 font-semibold">Nizamabad</p>
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-center py-4 space-x-2">
                        <button class="testimonial-dot w-3 h-3 rounded-full bg-secondary shadow-md transition-all duration-300 hover:scale-110" onclick="goToTestimonial(0)"></button>
                        <button class="testimonial-dot w-3 h-3 rounded-full bg-gray-400 shadow-md transition-all duration-300 hover:scale-110" onclick="goToTestimonial(1)"></button>
                        <button class="testimonial-dot w-3 h-3 rounded-full bg-gray-400 shadow-md transition-all duration-300 hover:scale-110" onclick="goToTestimonial(2)"></button>
                    </div>
                </div>
            </div>

            <!-- Service Gallery -->
            <div class="p-4">
                <h2 class="text-xl font-bold text-accent mb-4">Our Services in Action</h2>
                <div class="grid grid-cols-2 gap-3 mb-4">
                    <div class="relative rounded-xl overflow-hidden shadow-lg group cursor-pointer" onclick="showPage('servicesPage')">
                        <img src="https://images.unsplash.com/photo-1621905251189-08b45d6a269e?w=300&h=200&fit=crop" alt="Professional Plumbing Service" class="w-full h-32 object-cover group-hover:scale-110 transition-transform duration-300">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                        <div class="absolute bottom-2 left-2 text-white">
                            <h3 class="font-semibold text-sm">Professional Plumbing</h3>
                            <p class="text-xs opacity-90">Expert pipe & drainage solutions</p>
                        </div>
                    </div>
                    <div class="relative rounded-xl overflow-hidden shadow-lg group cursor-pointer" onclick="showPage('servicesPage')">
                        <img src="https://images.unsplash.com/photo-1621905252507-b35492cc74b4?w=300&h=200&fit=crop" alt="Electrical Services" class="w-full h-32 object-cover group-hover:scale-110 transition-transform duration-300">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                        <div class="absolute bottom-2 left-2 text-white">
                            <h3 class="font-semibold text-sm">Electrical Services</h3>
                            <p class="text-xs opacity-90">Safe wiring & repair work</p>
                        </div>
                    </div>
                    <div class="relative rounded-xl overflow-hidden shadow-lg group cursor-pointer" onclick="showPage('transportPage')">
                        <img src="https://images.unsplash.com/photo-1449824913935-59a10b8d2000?w=300&h=200&fit=crop" alt="Transport Services" class="w-full h-32 object-cover group-hover:scale-110 transition-transform duration-300">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                        <div class="absolute bottom-2 left-2 text-white">
                            <h3 class="font-semibold text-sm">Transport & Tours</h3>
                            <p class="text-xs opacity-90">Reliable local & tour services</p>
                        </div>
                    </div>
                    <div class="relative rounded-xl overflow-hidden shadow-lg group cursor-pointer" onclick="showPage('storePage')">
                        <img src="https://images.unsplash.com/photo-1542838132-92c53300491e?w=300&h=200&fit=crop" alt="Fresh Groceries" class="w-full h-32 object-cover group-hover:scale-110 transition-transform duration-300">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                        <div class="absolute bottom-2 left-2 text-white">
                            <h3 class="font-semibold text-sm">Fresh Groceries</h3>
                            <p class="text-xs opacity-90">Quality produce delivered fresh</p>
                        </div>
                    </div>
                </div>
                <div class="grid grid-cols-3 gap-2">
                    <div class="relative rounded-lg overflow-hidden shadow-md group cursor-pointer" onclick="showPage('servicesPage')">
                        <img src="https://images.unsplash.com/photo-1589939705384-5185137a7f0f?w=200&h=120&fit=crop" alt="Painting Services" class="w-full h-20 object-cover group-hover:scale-110 transition-transform duration-300">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>
                        <div class="absolute bottom-1 left-1 text-white">
                            <p class="text-xs font-semibold">Painting</p>
                        </div>
                    </div>
                    <div class="relative rounded-lg overflow-hidden shadow-md group cursor-pointer" onclick="showPage('servicesPage')">
                        <img src="https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=200&h=120&fit=crop" alt="Cleaning Services" class="w-full h-20 object-cover group-hover:scale-110 transition-transform duration-300">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>
                        <div class="absolute bottom-1 left-1 text-white">
                            <p class="text-xs font-semibold">Cleaning</p>
                        </div>
                    </div>
                    <div class="relative rounded-lg overflow-hidden shadow-md group cursor-pointer" onclick="showPage('eventsPage')">
                        <img src="https://images.unsplash.com/photo-1519741497674-611481863552?w=200&h=120&fit=crop" alt="Event Management" class="w-full h-20 object-cover group-hover:scale-110 transition-transform duration-300">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>
                        <div class="absolute bottom-1 left-1 text-white">
                            <p class="text-xs font-semibold">Events</p>
                        </div>
                    </div>
                </div>
            </div>



            <!-- Need Help Section -->
            <div class="p-4">
                <div class="bg-gray-100 rounded-xl p-4 text-center">
                    <h3 class="font-semibold mb-2 text-black">Need Help?</h3>
                    <p class="text-sm mb-3 text-black">Contact us for any questions or support with our professional services</p>
                    <div class="flex justify-center gap-4">
                        <a href="tel:7799086877" class="bg-white text-secondary px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 hover:bg-gray-100 transition-colors">
                            <i class="fas fa-phone"></i>
                            Call Us
                        </a>
                        <a href="https://wa.me/917799086877" target="_blank" rel="noopener noreferrer" class="help-whatsapp bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 hover:bg-green-600 transition-colors">
                            <i class="fab fa-whatsapp"></i>
                            WhatsApp
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Store Page -->
        <div id="storePage" class="page hidden">
            <!-- Fixed Store Header -->
            <div class="fixed top-16 left-0 right-0 bg-primary z-40 shadow-sm border-b border-gray-200">
                <div class="p-4">
                    <div class="flex items-center gap-3 mb-4">
                        <button onclick="showPage('homePage')" class="text-secondary">
                            <i class="fas fa-arrow-left text-xl"></i>
                        </button>
                        <h2 class="text-xl font-bold text-accent">Mana Store</h2>
                        <div class="ml-auto flex gap-2">
                            <button onclick="toggleWishlist()" class="text-secondary p-2 relative">
                                <i class="fas fa-heart text-xl"></i>
                                <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center shadow-md" id="wishlistCount" style="display: none;">0</span>
                            </button>
                            <button onclick="toggleCart()" class="text-secondary p-2 relative">
                                <i class="fas fa-shopping-cart text-xl"></i>
                                <span class="absolute -top-1 -right-1 bg-green-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center shadow-md" id="cartCount" style="display: none;">0</span>
                            </button>
                        </div>
                    </div>

                    <!-- Search Bar -->
                    <div class="mb-4">
                        <div class="relative">
                            <input type="text" id="searchInput" placeholder="Search products..." 
                                   class="w-full p-3 pl-10 pr-10 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary bg-white"
                                   oninput="searchProducts(this.value)">
                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary"></i>
                            <button id="clearSearch" onclick="clearSearch()" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-secondary transition-colors" style="display: none;">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div id="searchResults" class="mt-2 text-sm text-gray-600" style="display: none;"></div>
                    </div>
                </div>
            </div>

            <!-- Store Content with Top Padding -->
            <div class="pt-44 p-4">

                <!-- Categories -->
                <div class="mb-4">
                    <h3 class="font-semibold text-accent mb-3">Categories</h3>
                    <div class="flex gap-3 overflow-x-auto pb-2" style="scrollbar-width: none; -ms-overflow-style: none;">
                        <div class="category-card bg-secondary text-white rounded-lg p-3 text-center shadow-md cursor-pointer flex-shrink-0 w-24" data-category="vegetables" onclick="showCategory('vegetables')">
                            <img src="https://images.unsplash.com/photo-1540420773420-3366772f4999?w=100&h=80&fit=crop" alt="Vegetables" class="w-full h-16 object-cover rounded mb-2">
                            <p class="text-xs font-semibold">Vegetables</p>
                        </div>
                        <div class="category-card bg-white rounded-lg p-3 text-center shadow-md cursor-pointer flex-shrink-0 w-24" data-category="fruits" onclick="showCategory('fruits')">
                            <img src="https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=100&h=80&fit=crop" alt="Fruits" class="w-full h-16 object-cover rounded mb-2">
                            <p class="text-xs font-semibold">Fruits</p>
                        </div>
                        <div class="category-card bg-white rounded-lg p-3 text-center shadow-md cursor-pointer flex-shrink-0 w-24" data-category="dairy" onclick="showCategory('dairy')">
                            <img src="https://images.unsplash.com/photo-1563636619-e9143da7973b?w=100&h=80&fit=crop" alt="Dairy" class="w-full h-16 object-cover rounded mb-2">
                            <p class="text-xs font-semibold">Dairy</p>
                        </div>
                        <div class="category-card bg-white rounded-lg p-3 text-center shadow-md cursor-pointer flex-shrink-0 w-24" data-category="grains" onclick="showCategory('grains')">
                            <img src="https://images.unsplash.com/photo-1574323347407-f5e1ad6d020b?w=100&h=80&fit=crop" alt="Grains" class="w-full h-16 object-cover rounded mb-2">
                            <p class="text-xs font-semibold">Grains</p>
                        </div>
                        <div class="category-card bg-white rounded-lg p-3 text-center shadow-md cursor-pointer flex-shrink-0 w-24" data-category="spices" onclick="showCategory('spices')">
                            <img src="https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=100&h=80&fit=crop" alt="Spices" class="w-full h-16 object-cover rounded mb-2">
                            <p class="text-xs font-semibold">Spices</p>
                        </div>
                        <div class="category-card bg-white rounded-lg p-3 text-center shadow-md cursor-pointer flex-shrink-0 w-24" data-category="snacks" onclick="showCategory('snacks')">
                            <img src="https://images.unsplash.com/photo-1621939514649-280e2ee25f60?w=100&h=80&fit=crop" alt="Snacks" class="w-full h-16 object-cover rounded mb-2">
                            <p class="text-xs font-semibold">Snacks</p>
                        </div>
                    </div>
                </div>

                <!-- Products Grid -->
                <div id="productsGrid" class="grid grid-cols-2 gap-4">
                    <!-- Products will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Transport Page -->
        <div id="transportPage" class="page hidden">
            <div class="p-4">
                <div class="flex items-center gap-3 mb-4">
                    <button onclick="showPage('homePage')" class="text-secondary">
                        <i class="fas fa-arrow-left text-xl"></i>
                    </button>
                    <h2 class="text-xl font-bold text-accent">Transport & Tours</h2>
                </div>

                <div class="space-y-4">
                    <div class="bg-white rounded-xl p-4 shadow-md">
                        <h3 class="font-semibold text-accent mb-3">Local Transport</h3>
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="bookTransport('bike')" class="transport-option bg-secondary text-white p-3 rounded-lg text-center">
                                <i class="fas fa-motorcycle text-2xl mb-2"></i>
                                <p class="text-sm">Bike</p>
                            </button>
                            <button onclick="bookTransport('auto')" class="transport-option bg-secondary text-white p-3 rounded-lg text-center">
                                <i class="fas fa-taxi text-2xl mb-2"></i>
                                <p class="text-sm">Auto</p>
                            </button>
                            <button onclick="bookTransport('car')" class="transport-option bg-secondary text-white p-3 rounded-lg text-center">
                                <i class="fas fa-car text-2xl mb-2"></i>
                                <p class="text-sm">Car</p>
                            </button>
                            <button onclick="bookTransport('bus')" class="transport-option bg-secondary text-white p-3 rounded-lg text-center">
                                <i class="fas fa-bus text-2xl mb-2"></i>
                                <p class="text-sm">Bus</p>
                            </button>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl p-4 shadow-md">
                        <h3 class="font-semibold text-accent mb-3">Tours & Travels</h3>
                        <div class="space-y-3">
                            <button onclick="bookTour('hyderabad')" class="w-full bg-accent text-white p-3 rounded-lg text-left">
                                <i class="fas fa-map-marker-alt mr-2"></i>
                                Hyderabad City Tour
                            </button>
                            <button onclick="bookTour('warangal')" class="w-full bg-accent text-white p-3 rounded-lg text-left">
                                <i class="fas fa-map-marker-alt mr-2"></i>
                                Warangal Heritage Tour
                            </button>
                            <button onclick="bookTour('ramoji')" class="w-full bg-accent text-white p-3 rounded-lg text-left">
                                <i class="fas fa-map-marker-alt mr-2"></i>
                                Ramoji Film City
                            </button>
                        </div>
                    </div>
                </div>
            </div>



            <!-- Need Help Section -->
            <div class="p-4">
                <div class="bg-gray-100 rounded-xl p-4 text-center">
                    <h3 class="font-semibold mb-2 text-black">Need Help?</h3>
                    <p class="text-sm mb-3 text-black">Contact us for any questions or support with our transport services</p>
                    <div class="flex justify-center gap-4">
                        <a href="tel:7799086877" class="bg-white text-secondary px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 hover:bg-gray-100 transition-colors">
                            <i class="fas fa-phone"></i>
                            Call Us
                        </a>
                        <a href="https://wa.me/917799086877" target="_blank" rel="noopener noreferrer" class="help-whatsapp bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 hover:bg-green-600 transition-colors">
                            <i class="fab fa-whatsapp"></i>
                            WhatsApp
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Services Page -->
        <div id="servicesPage" class="page hidden">
            <div class="p-4">
                <div class="flex items-center gap-3 mb-4">
                    <button onclick="showPage('homePage')" class="text-secondary">
                        <i class="fas fa-arrow-left text-xl"></i>
                    </button>
                    <h2 class="text-xl font-bold text-accent">Professional Services</h2>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div class="service-card bg-white rounded-xl p-4 shadow-md cursor-pointer" onclick="bookService('plumber')">
                        <img src="https://images.unsplash.com/photo-1621905251189-08b45d6a269e?w=200&h=120&fit=crop" alt="Plumber" class="w-full h-20 object-cover rounded-lg mb-2">
                        <h3 class="font-semibold text-accent">Plumber</h3>
                        <p class="text-sm text-gray-600">Pipe & Drainage</p>
                    </div>
                    <div class="service-card bg-white rounded-xl p-4 shadow-md cursor-pointer" onclick="bookService('electrician')">
                        <img src="https://images.unsplash.com/photo-1621905252507-b35492cc74b4?w=200&h=120&fit=crop" alt="Electrician" class="w-full h-20 object-cover rounded-lg mb-2">
                        <h3 class="font-semibold text-accent">Electrician</h3>
                        <p class="text-sm text-gray-600">Wiring & Repair</p>
                    </div>
                    <div class="service-card bg-white rounded-xl p-4 shadow-md cursor-pointer" onclick="bookService('painter')">
                        <img src="https://images.unsplash.com/photo-1589939705384-5185137a7f0f?w=200&h=120&fit=crop" alt="Painter" class="w-full h-20 object-cover rounded-lg mb-2">
                        <h3 class="font-semibold text-accent">Painter</h3>
                        <p class="text-sm text-gray-600">Interior & Exterior</p>
                    </div>
                    <div class="service-card bg-white rounded-xl p-4 shadow-md cursor-pointer" onclick="bookService('barber')">
                        <img src="https://images.unsplash.com/photo-1503951914875-452162b0f3f1?w=200&h=120&fit=crop" alt="Barber" class="w-full h-20 object-cover rounded-lg mb-2">
                        <h3 class="font-semibold text-accent">Barber</h3>
                        <p class="text-sm text-gray-600">Hair & Grooming</p>
                    </div>
                    <div class="service-card bg-white rounded-xl p-4 shadow-md cursor-pointer" onclick="bookService('cleaner')">
                        <img src="https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=200&h=120&fit=crop" alt="Cleaner" class="w-full h-20 object-cover rounded-lg mb-2">
                        <h3 class="font-semibold text-accent">House Cleaning</h3>
                        <p class="text-sm text-gray-600">Deep & Regular</p>
                    </div>
                    <div class="service-card bg-white rounded-xl p-4 shadow-md cursor-pointer" onclick="bookService('carpenter')">
                        <img src="https://images.unsplash.com/photo-1504148455328-c376907d081c?w=200&h=120&fit=crop" alt="Carpenter" class="w-full h-20 object-cover rounded-lg mb-2">
                        <h3 class="font-semibold text-accent">Carpenter</h3>
                        <p class="text-sm text-gray-600">Furniture & Repair</p>
                    </div>
                </div>
            </div>



            <!-- Need Help Section -->
            <div class="p-4">
                <div class="bg-gray-100 rounded-xl p-4 text-center">
                    <h3 class="font-semibold mb-2 text-black">Need Help?</h3>
                    <p class="text-sm mb-3 text-black">Contact us for any questions or support with our professional services</p>
                    <div class="flex justify-center gap-4">
                        <a href="tel:7799086877" class="bg-white text-secondary px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 hover:bg-gray-100 transition-colors">
                            <i class="fas fa-phone"></i>
                            Call Us
                        </a>
                        <a href="https://wa.me/917799086877" target="_blank" rel="noopener noreferrer" class="help-whatsapp bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 hover:bg-green-600 transition-colors">
                            <i class="fab fa-whatsapp"></i>
                            WhatsApp
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Events Page -->
        <div id="eventsPage" class="page hidden">
            <div class="p-4">
                <div class="flex items-center gap-3 mb-4">
                    <button onclick="showPage('homePage')" class="text-secondary">
                        <i class="fas fa-arrow-left text-xl"></i>
                    </button>
                    <h2 class="text-xl font-bold text-accent">Event Management</h2>
                </div>

                <div class="space-y-4">
                    <div class="event-card bg-white rounded-xl p-4 shadow-md cursor-pointer" onclick="bookEvent('wedding')">
                        <img src="https://images.unsplash.com/photo-1519741497674-611481863552?w=400&h=200&fit=crop" alt="Wedding" class="w-full h-32 object-cover rounded-lg mb-3">
                        <h3 class="font-semibold text-accent">Wedding Events</h3>
                        <p class="text-sm text-gray-600">Complete wedding planning & management</p>
                    </div>
                    <div class="event-card bg-white rounded-xl p-4 shadow-md cursor-pointer" onclick="bookEvent('birthday')">
                        <img src="https://images.unsplash.com/photo-1530103862676-de8c9debad1d?w=400&h=200&fit=crop" alt="Birthday" class="w-full h-32 object-cover rounded-lg mb-3">
                        <h3 class="font-semibold text-accent">Birthday Parties</h3>
                        <p class="text-sm text-gray-600">Memorable birthday celebrations</p>
                    </div>
                    <div class="event-card bg-white rounded-xl p-4 shadow-md cursor-pointer" onclick="bookEvent('corporate')">
                        <img src="https://images.unsplash.com/photo-1511578314322-379afb476865?w=400&h=200&fit=crop" alt="Corporate" class="w-full h-32 object-cover rounded-lg mb-3">
                        <h3 class="font-semibold text-accent">Corporate Events</h3>
                        <p class="text-sm text-gray-600">Professional event management</p>
                    </div>
                </div>
            </div>



            <!-- Need Help Section -->
            <div class="p-4">
                <div class="bg-gray-100 rounded-xl p-4 text-center">
                    <h3 class="font-semibold mb-2 text-black">Need Help?</h3>
                    <p class="text-sm mb-3 text-black">Contact us for any questions or support with our event management services</p>
                    <div class="flex justify-center gap-4">
                        <a href="tel:7799086877" class="bg-white text-secondary px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 hover:bg-gray-100 transition-colors">
                            <i class="fas fa-phone"></i>
                            Call Us
                        </a>
                        <a href="https://wa.me/917799086877" target="_blank" rel="noopener noreferrer" class="help-whatsapp bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 hover:bg-green-600 transition-colors">
                            <i class="fab fa-whatsapp"></i>
                            WhatsApp
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Business Page -->
        <div id="businessPage" class="page hidden">
            <div class="p-4">
                <div class="flex items-center gap-3 mb-4">
                    <button onclick="showPage('homePage')" class="text-secondary">
                        <i class="fas fa-arrow-left text-xl"></i>
                    </button>
                    <h2 class="text-xl font-bold text-accent">Business Support</h2>
                </div>

                <div class="space-y-4">
                    <div class="business-card bg-white rounded-xl p-4 shadow-md">
                        <h3 class="font-semibold text-accent mb-3">Digital Services</h3>
                        <div class="space-y-2">
                            <button onclick="requestService('digital-marketing')" class="w-full bg-secondary text-white p-3 rounded-lg text-left">
                                <i class="fas fa-bullhorn mr-2"></i>
                                Digital Marketing
                            </button>
                            <button onclick="requestService('website-development')" class="w-full bg-secondary text-white p-3 rounded-lg text-left">
                                <i class="fas fa-code mr-2"></i>
                                Website Development
                            </button>
                        </div>
                    </div>

                    <div class="business-card bg-white rounded-xl p-4 shadow-md">
                        <h3 class="font-semibold text-accent mb-3">Delivery Partners</h3>
                        <div class="space-y-2">
                            <button onclick="requestService('home-delivery')" class="w-full bg-accent text-white p-3 rounded-lg text-left">
                                <i class="fas fa-home mr-2"></i>
                                Home Based Business
                            </button>
                            <button onclick="requestService('restaurant-delivery')" class="w-full bg-accent text-white p-3 rounded-lg text-left">
                                <i class="fas fa-utensils mr-2"></i>
                                Restaurant Delivery
                            </button>
                            <button onclick="requestService('logistics')" class="w-full bg-accent text-white p-3 rounded-lg text-left">
                                <i class="fas fa-truck mr-2"></i>
                                Logistics Support
                            </button>
                        </div>
                    </div>
                </div>
            </div>



            <!-- Need Help Section -->
            <div class="p-4">
                <div class="bg-gray-100 rounded-xl p-4 text-center">
                    <h3 class="font-semibold mb-2 text-black">Need Help?</h3>
                    <p class="text-sm mb-3 text-black">Contact us for any questions or support with our business services</p>
                    <div class="flex justify-center gap-4">
                        <a href="tel:7799086877" class="bg-white text-secondary px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 hover:bg-gray-100 transition-colors">
                            <i class="fas fa-phone"></i>
                            Call Us
                        </a>
                        <a href="https://wa.me/917799086877" target="_blank" rel="noopener noreferrer" class="help-whatsapp bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 hover:bg-green-600 transition-colors">
                            <i class="fab fa-whatsapp"></i>
                            WhatsApp
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Join Page -->
        <div id="joinPage" class="page hidden">
            <div class="p-4">
                <div class="flex items-center gap-3 mb-4">
                    <button onclick="showPage('homePage')" class="text-secondary">
                        <i class="fas fa-arrow-left text-xl"></i>
                    </button>
                    <h2 class="text-xl font-bold text-accent">Join Mana Delivery</h2>
                </div>

                <div class="space-y-4">
                    <div class="bg-white rounded-xl p-4 shadow-md">
                        <h3 class="font-semibold text-accent mb-3">Join as Partner</h3>
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="joinAs('vendor')" class="join-option bg-secondary text-white p-3 rounded-lg text-center">
                                <i class="fas fa-store text-2xl mb-2"></i>
                                <p class="text-sm">Vendor</p>
                            </button>
                            <button onclick="joinAs('driver')" class="join-option bg-secondary text-white p-3 rounded-lg text-center">
                                <i class="fas fa-car text-2xl mb-2"></i>
                                <p class="text-sm">Driver</p>
                            </button>
                            <button onclick="joinAs('delivery-boy')" class="join-option bg-secondary text-white p-3 rounded-lg text-center">
                                <i class="fas fa-motorcycle text-2xl mb-2"></i>
                                <p class="text-sm">Delivery Boy</p>
                            </button>
                            <button onclick="joinAs('shop-owner')" class="join-option bg-secondary text-white p-3 rounded-lg text-center">
                                <i class="fas fa-shopping-bag text-2xl mb-2"></i>
                                <p class="text-sm">Shop Owner</p>
                            </button>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl p-4 shadow-md">
                        <h3 class="font-semibold text-accent mb-4">About Mana Delivery</h3>
                        <p class="text-gray-700 text-sm leading-relaxed mb-4">
                            Mana Delivery is Telangana's comprehensive service platform connecting customers with local businesses, service providers, and delivery partners. We're committed to supporting local economy and providing convenient solutions for everyday needs.
                        </p>
                        <div class="space-y-2">
                            <div class="flex items-center gap-2">
                                <i class="fas fa-check-circle text-green-500"></i>
                                <span class="text-sm">24/7 Customer Support</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-check-circle text-green-500"></i>
                                <span class="text-sm">Local Business Focus</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-check-circle text-green-500"></i>
                                <span class="text-sm">Fair Partnership Terms</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>



            <!-- Need Help Section -->
            <div class="p-4">
                <div class="bg-gray-100 rounded-xl p-4 text-center">
                    <h3 class="font-semibold mb-2 text-black">Need Help?</h3>
                    <p class="text-sm mb-3 text-black">Contact us for any questions about joining our partner network</p>
                    <div class="flex justify-center gap-4">
                        <a href="tel:7799086877" class="bg-white text-secondary px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 hover:bg-gray-100 transition-colors">
                            <i class="fas fa-phone"></i>
                            Call Us
                        </a>
                        <a href="https://wa.me/917799086877" target="_blank" rel="noopener noreferrer" class="help-whatsapp bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 hover:bg-green-600 transition-colors">
                            <i class="fab fa-whatsapp"></i>
                            WhatsApp
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Cart Modal -->
    <div id="cartModal" class="modal">
        <div class="bg-white rounded-xl p-6 m-4 max-w-md w-full max-h-[80vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-accent">Your Cart</h3>
                <button onclick="toggleCart()" class="text-gray-500">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="cartItems" class="space-y-3 mb-4">
                <!-- Cart items will be added here -->
            </div>
            <div class="border-t pt-4">
                <button onclick="proceedToCheckout()" class="w-full bg-secondary text-white p-3 rounded-lg font-semibold">
                    Proceed to Checkout
                </button>
            </div>
        </div>
    </div>

    <!-- Wishlist Modal -->
    <div id="wishlistModal" class="modal">
        <div class="bg-white rounded-xl p-6 m-4 max-w-md w-full max-h-[80vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-accent">Your Wishlist</h3>
                <button onclick="toggleWishlist()" class="text-gray-500">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="wishlistItems" class="space-y-3 mb-4">
                <!-- Wishlist items will be added here -->
            </div>
            <div class="border-t pt-4 text-center text-gray-500" id="wishlistEmpty" style="display: none;">
                <i class="fas fa-heart text-4xl mb-2 opacity-50"></i>
                <p>Your wishlist is empty</p>
            </div>
        </div>
    </div>

    <!-- Confirmation Popup -->
    <div id="confirmationPopup" class="modal">
        <div class="bg-white rounded-xl p-6 m-4 max-w-sm w-full text-center shadow-2xl">
            <div class="mb-4">
                <div id="confirmationIcon" class="text-4xl mb-2"></div>
                <h3 id="confirmationTitle" class="text-lg font-bold text-accent mb-2"></h3>
                <p id="confirmationMessage" class="text-gray-600"></p>
            </div>
            <button onclick="closeConfirmation()" class="bg-secondary text-white px-6 py-2 rounded-lg font-semibold">
                OK
            </button>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkoutModal" class="modal">
        <div class="bg-white rounded-xl p-6 m-4 max-w-md w-full max-h-[80vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-accent">Customer Details</h3>
                <button onclick="closeCheckout()" class="text-gray-500">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="checkoutForm" class="space-y-4">
                <div>
                    <label for="customerName" class="block text-sm font-semibold text-accent mb-1">Full Name</label>
                    <input type="text" id="customerName" name="customerName" required class="w-full p-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary">
                </div>
                <div>
                    <label for="customerPhone" class="block text-sm font-semibold text-accent mb-1">Phone Number</label>
                    <input type="tel" id="customerPhone" name="customerPhone" required class="w-full p-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary">
                </div>
                <div>
                    <label for="customerAddress" class="block text-sm font-semibold text-accent mb-1">Address</label>
                    <textarea id="customerAddress" name="customerAddress" required rows="3" class="w-full p-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary"></textarea>
                </div>
                <div id="checkoutLocationStatus" class="bg-blue-50 p-3 rounded-lg">
                    <p class="text-sm font-semibold text-blue-800">
                        <i class="fas fa-map-marker-alt mr-2"></i>
                        <span id="checkoutLocationText">Location will be captured during order for accurate delivery</span>
                    </p>
                </div>
                <button type="submit" class="w-full bg-green-500 text-white p-3 rounded-lg font-semibold flex items-center justify-center gap-2">
                    <i class="fab fa-whatsapp"></i>
                    Order via WhatsApp
                </button>
            </form>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav bg-white shadow-lg border-t">
        <div class="flex justify-around items-center py-2">
            <button onclick="showPage('homePage')" class="nav-item flex flex-col items-center p-2 text-secondary" data-page="homePage">
                <i class="fas fa-home text-xl mb-1"></i>
                <span class="text-xs">Home</span>
            </button>
            <button onclick="showPage('storePage')" class="nav-item flex flex-col items-center p-2 text-gray-400" data-page="storePage">
                <i class="fas fa-store text-xl mb-1"></i>
                <span class="text-xs">Store</span>
            </button>
            <button onclick="showPage('servicesPage')" class="nav-item flex flex-col items-center p-2 text-gray-400" data-page="servicesPage">
                <i class="fas fa-concierge-bell text-xl mb-1"></i>
                <span class="text-xs">Services</span>
            </button>
            <button onclick="showPage('transportPage')" class="nav-item flex flex-col items-center p-2 text-gray-400" data-page="transportPage">
                <i class="fas fa-car text-xl mb-1"></i>
                <span class="text-xs">Transport</span>
            </button>
            <button onclick="showPage('joinPage')" class="nav-item flex flex-col items-center p-2 text-gray-400" data-page="joinPage">
                <i class="fas fa-users text-xl mb-1"></i>
                <span class="text-xs">Join</span>
            </button>
        </div>
    </nav>

    <!-- Location Selector Modal -->
    <div id="locationSelectorModal" class="modal">
        <div class="bg-white rounded-xl p-6 m-4 max-w-md w-full max-h-[80vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-accent">Select Your Location</h3>
                <button onclick="closeLocationSelector()" class="text-gray-500">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <p class="text-sm text-gray-600 mb-4">Choose your location to get personalized service and contact details</p>
            <div class="space-y-2" id="locationList">
                <!-- Location options will be populated here -->
            </div>
            <div class="mt-6 pt-4 border-t">
                <button onclick="requestLocationPermission()" class="w-full bg-secondary text-white p-3 rounded-lg font-semibold flex items-center justify-center gap-2">
                    <i class="fas fa-crosshairs"></i>
                    Auto-Detect My Location
                </button>
            </div>
        </div>
    </div>





    <!-- Location Permission Popup -->
    <div id="locationPopup" class="modal">
        <div class="location-popup">
            <div class="flex items-center justify-center gap-2 mb-3">
                <i class="fas fa-map-marker-alt text-2xl"></i>
                <span class="font-bold text-lg">Location Required</span>
            </div>
            <p class="text-sm mb-4 opacity-90">Please turn on location in your mobile and accept location permission for better service delivery</p>
            <div class="space-y-3">
                <button type="button" onclick="requestLocationPermission()" class="w-full bg-white text-orange-600 px-4 py-3 rounded-full font-semibold text-sm hover:bg-gray-100 transition-colors">
                    <i class="fas fa-location-arrow mr-2"></i>
                    Enable Location
                </button>
                <button type="button" onclick="closeLocationPopup()" class="w-full bg-transparent border-2 border-white text-white px-4 py-2 rounded-full font-semibold text-sm hover:bg-white hover:text-orange-600 transition-colors">
                    Skip for Now
                </button>
            </div>
        </div>
    </div>

    <!-- Information popups removed -->

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script>
        // Global variables
        let currentPage = 'homePage';
        let cart = [];
        let wishlist = [];
        let currentLocation = null;
        let carouselIndex = 0;
        let testimonialIndex = 0;
        let offersCarouselIndex = 0;
        let pendingAction = null;
        let pendingData = null;
        let selectedLocationData = null;

        // Location-based WhatsApp numbers
        const locationNumbers = {
            'khanapur': { name: 'Khanapur', number: '7799086877' },
            'nirmal': { name: 'Nirmal', number: '7799086877' },
            'kaddam': { name: 'Kaddam', number: '7799086877' },
            'metpally': { name: 'Metpally', number: '7799086877' },
            'armour': { name: 'Armour', number: '7799086877' },
            'laxetpet': { name: 'Laxetpet', number: '7799086877' },
            'adilabad': { name: 'Adilabad', number: '7799086877' },
            'nizamabad': { name: 'Nizamabad', number: '7799086877' },
            'karimnagar': { name: 'Karimnagar', number: '7799086877' },
            'jannaram': { name: 'Jannaram', number: '7799086877' }
        };

        // Sample products data
        const products = {
            vegetables: [
                { id: 1, name: 'Tomatoes', image: 'https://images.unsplash.com/photo-1546470427-e5b89b618b84?w=200&h=150&fit=crop', unit: 'kg' },
                { id: 2, name: 'Onions', image: 'https://images.unsplash.com/photo-1508747703725-719777637510?w=200&h=150&fit=crop', unit: 'kg' },
                { id: 3, name: 'Potatoes', image: 'https://images.unsplash.com/photo-1518977676601-b53f82aba655?w=200&h=150&fit=crop', unit: 'kg' },
                { id: 4, name: 'Carrots', image: 'https://images.unsplash.com/photo-1445282768818-728615cc910a?w=200&h=150&fit=crop', unit: 'kg' }
            ],
            fruits: [
                { id: 5, name: 'Apples', image: 'https://images.unsplash.com/photo-1560806887-1e4cd0b6cbd6?w=200&h=150&fit=crop', unit: 'kg' },
                { id: 6, name: 'Bananas', image: 'https://images.unsplash.com/photo-1571771894821-ce9b6c11b08e?w=200&h=150&fit=crop', unit: 'dozen' },
                { id: 7, name: 'Oranges', image: 'https://images.unsplash.com/photo-1547514701-42782101795e?w=200&h=150&fit=crop', unit: 'kg' },
                { id: 8, name: 'Grapes', image: 'https://images.unsplash.com/photo-1537640538966-79f369143f8f?w=200&h=150&fit=crop', unit: 'kg' }
            ],
            dairy: [
                { id: 9, name: 'Milk', image: 'https://images.unsplash.com/photo-1563636619-e9143da7973b?w=200&h=150&fit=crop', unit: 'liter' },
                { id: 10, name: 'Yogurt', image: 'https://images.unsplash.com/photo-1488477181946-6428a0291777?w=200&h=150&fit=crop', unit: 'cup' },
                { id: 11, name: 'Cheese', image: 'https://images.unsplash.com/photo-1486297678162-eb2a19b0a32d?w=200&h=150&fit=crop', unit: 'pack' },
                { id: 12, name: 'Butter', image: 'https://images.unsplash.com/photo-1589985270826-4b7bb135bc9d?w=200&h=150&fit=crop', unit: 'pack' }
            ],
            grains: [
                { id: 13, name: 'Rice', image: 'https://images.unsplash.com/photo-1574323347407-f5e1ad6d020b?w=200&h=150&fit=crop', unit: 'kg' },
                { id: 14, name: 'Wheat', image: 'https://images.unsplash.com/photo-1574323347407-f5e1ad6d020b?w=200&h=150&fit=crop', unit: 'kg' },
                { id: 15, name: 'Lentils', image: 'https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=200&h=150&fit=crop', unit: 'kg' },
                { id: 16, name: 'Chickpeas', image: 'https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=200&h=150&fit=crop', unit: 'kg' }
            ],
            spices: [
                { id: 17, name: 'Turmeric', image: 'https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=200&h=150&fit=crop', unit: 'grams' },
                { id: 18, name: 'Red Chili', image: 'https://images.unsplash.com/photo-1583454110551-21f2fa2afe61?w=200&h=150&fit=crop', unit: 'grams' },
                { id: 19, name: 'Coriander', image: 'https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=200&h=150&fit=crop', unit: 'grams' },
                { id: 20, name: 'Cumin', image: 'https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=200&h=150&fit=crop', unit: 'grams' }
            ],
            snacks: [
                { id: 21, name: 'Biscuits', image: 'https://images.unsplash.com/photo-1621939514649-280e2ee25f60?w=200&h=150&fit=crop', unit: 'pack' },
                { id: 22, name: 'Chips', image: 'https://images.unsplash.com/photo-1566478989037-eec170784d0b?w=200&h=150&fit=crop', unit: 'pack' },
                { id: 23, name: 'Namkeen', image: 'https://images.unsplash.com/photo-1621939514649-280e2ee25f60?w=200&h=150&fit=crop', unit: 'pack' },
                { id: 24, name: 'Chocolates', image: 'https://images.unsplash.com/photo-1511381939415-e44015466834?w=200&h=150&fit=crop', unit: 'pack' }
            ]
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeCarousel();
            initializeOffersCarousel();
            initializeTestimonialCarousel();
            checkInitialLocationStatus();
            showCategory('vegetables');
            initializeLocationSelector();
            loadSavedLocation();
            
            // Add enhanced interactions
            addEnhancedInteractions();
            
            // Add location validation to all action buttons
            addLocationValidation();
        });

        function addLocationValidation() {
            // Location validation removed - location is now optional
            // Functions will work without location but will attempt to capture it during order/booking
        }

        function initializeLocationSelector() {
            const locationList = document.getElementById('locationList');
            locationList.innerHTML = Object.entries(locationNumbers).map(([key, location]) => `
                <button onclick="selectLocation('${key}')" class="w-full text-left p-3 rounded-lg border border-gray-200 hover:bg-gray-50 hover:border-secondary transition-colors">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <i class="fas fa-map-marker-alt text-secondary"></i>
                            <span class="font-semibold text-accent">${location.name}</span>
                        </div>
                        <div class="text-xs text-gray-500">
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </div>
                </button>
            `).join('');
        }

        function loadSavedLocation() {
            const savedLocation = localStorage.getItem('selectedLocation');
            if (savedLocation && locationNumbers[savedLocation]) {
                selectLocation(savedLocation, false);
            }
        }

        function selectLocation(locationKey, showToast = true) {
            if (locationNumbers[locationKey]) {
                selectedLocationData = {
                    key: locationKey,
                    ...locationNumbers[locationKey]
                };
                
                // Update UI
                document.getElementById('selectedLocationName').textContent = selectedLocationData.name;
                
                // Update contact links
                updateContactLinks(selectedLocationData.number);
                
                // Save to localStorage
                localStorage.setItem('selectedLocation', locationKey);
                
                // Close modal
                closeLocationSelector();
                
                if (showToast) {
                    showToast(`Location set to ${selectedLocationData.name}`);
                }
            }
        }

        function updateContactLinks(phoneNumber) {
            const callBtn = document.getElementById('callBtn');
            const whatsappBtn = document.getElementById('whatsappBtn');
            
            if (callBtn) {
                callBtn.href = `tel:${phoneNumber}`;
            }
            
            if (whatsappBtn) {
                whatsappBtn.href = `https://wa.me/91${phoneNumber}`;
            }
            
            // Update all help section WhatsApp links
            document.querySelectorAll('.help-whatsapp').forEach(link => {
                link.href = `https://wa.me/91${phoneNumber}`;
            });
            
            // Update all other call links
            document.querySelectorAll('a[href*="tel:"]').forEach(link => {
                if (link.id !== 'callBtn') {
                    link.href = `tel:${phoneNumber}`;
                }
            });
        }

        function showLocationSelector() {
            const modal = document.getElementById('locationSelectorModal');
            modal.classList.add('active');
            document.body.classList.add('modal-open');
        }

        function closeLocationSelector() {
            const modal = document.getElementById('locationSelectorModal');
            modal.classList.remove('active');
            document.body.classList.remove('modal-open');
        }

        function checkInitialLocationStatus() {
            // Check if location is already available (optional)
            if (navigator.geolocation) {
                // Start continuous location tracking
                startLocationTracking();
                
                // Initial location capture with high accuracy (silent)
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        currentLocation = {
                            latitude: position.coords.latitude,
                            longitude: position.coords.longitude,
                            accuracy: position.coords.accuracy,
                            altitude: position.coords.altitude,
                            heading: position.coords.heading,
                            speed: position.coords.speed,
                            timestamp: position.timestamp
                        };
                        updateLocationStatus(true);
                        showToast(`📍 Location enabled with ${Math.round(position.coords.accuracy)}m accuracy`, 'success', 2000);
                    },
                    (error) => {
                        updateLocationStatus(false);
                        // Silent error handling - no popup shown
                        console.log('Location not available:', error.message);
                    },
                    { 
                        enableHighAccuracy: true,
                        timeout: 10000, 
                        maximumAge: 60000 
                    }
                );
            } else {
                updateLocationStatus(false);
                console.log('Geolocation not supported by this browser');
            }
        }

        // Carousel functionality
        function initializeCarousel() {
            const track = document.getElementById('carouselTrack');
            const slides = track.children;
            
            if (track && slides.length > 0) {
                setInterval(() => {
                    carouselIndex = (carouselIndex + 1) % slides.length;
                    track.style.transform = `translateX(-${carouselIndex * 100}%)`;
                }, 4000);
            }
        }

        // Offers carousel functionality
        function initializeOffersCarousel() {
            const track = document.getElementById('offersCarouselTrack');
            const dots = document.querySelectorAll('.offers-dot');
            
            if (track && dots.length > 0) {
                setInterval(() => {
                    offersCarouselIndex = (offersCarouselIndex + 1) % dots.length;
                    updateOffersCarousel();
                }, 5000);
            }
        }

        function goToOfferSlide(index) {
            offersCarouselIndex = index;
            updateOffersCarousel();
        }

        function updateOffersCarousel() {
            const track = document.getElementById('offersCarouselTrack');
            const dots = document.querySelectorAll('.offers-dot');
            
            if (track && dots.length > 0) {
                // Move track
                track.style.transform = `translateX(-${offersCarouselIndex * 100}%)`;
                
                // Update dots
                dots.forEach((dot, index) => {
                    if (index === offersCarouselIndex) {
                        dot.classList.remove('bg-gray-400');
                        dot.classList.add('bg-secondary');
                    } else {
                        dot.classList.remove('bg-secondary');
                        dot.classList.add('bg-gray-400');
                    }
                });
            }
        }

        // Testimonial carousel functionality
        function initializeTestimonialCarousel() {
            const track = document.getElementById('testimonialTrack');
            const dots = document.querySelectorAll('.testimonial-dot');
            
            if (track && dots.length > 0) {
                // Auto-advance testimonials every 4 seconds
                setInterval(() => {
                    testimonialIndex = (testimonialIndex + 1) % dots.length;
                    updateTestimonialCarousel();
                }, 4000);
            }
        }

        function goToTestimonial(index) {
            testimonialIndex = index;
            updateTestimonialCarousel();
        }

        function updateTestimonialCarousel() {
            const track = document.getElementById('testimonialTrack');
            const dots = document.querySelectorAll('.testimonial-dot');
            
            if (track && dots.length > 0) {
                // Move track
                track.style.transform = `translateX(-${testimonialIndex * 100}%)`;
                
                // Update dots
                dots.forEach((dot, index) => {
                    if (index === testimonialIndex) {
                        dot.classList.remove('bg-gray-400');
                        dot.classList.add('bg-secondary');
                    } else {
                        dot.classList.remove('bg-secondary');
                        dot.classList.add('bg-gray-400');
                    }
                });
            }
        }

        // Information popup functions removed

        function addEnhancedInteractions() {
            // Add loading states to buttons
            document.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', function() {
                    if (!this.classList.contains('loading')) {
                        this.classList.add('loading');
                        const originalText = this.innerHTML;
                        
                        // Add loading dots for certain actions
                        if (this.textContent.includes('WhatsApp') || this.textContent.includes('Request') || this.textContent.includes('Book')) {
                            this.innerHTML = `<i class="fas fa-spinner fa-spin mr-2"></i>Processing<span class="loading-dots"></span>`;
                            
                            setTimeout(() => {
                                this.innerHTML = originalText;
                                this.classList.remove('loading');
                            }, 1500);
                        } else {
                            setTimeout(() => {
                                this.classList.remove('loading');
                            }, 300);
                        }
                    }
                });
            });

            // Add hover effects to service cards
            document.querySelectorAll('.grid-card, .service-card, .event-card, .business-card').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-4px) scale(1.02)';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0) scale(1)';
                });
            });

            // Add ripple effect to buttons
            document.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', function(e) {
                    const ripple = document.createElement('span');
                    const rect = this.getBoundingClientRect();
                    const size = Math.max(rect.width, rect.height);
                    const x = e.clientX - rect.left - size / 2;
                    const y = e.clientY - rect.top - size / 2;
                    
                    ripple.style.cssText = `
                        position: absolute;
                        width: ${size}px;
                        height: ${size}px;
                        left: ${x}px;
                        top: ${y}px;
                        background: rgba(255,255,255,0.3);
                        border-radius: 50%;
                        transform: scale(0);
                        animation: ripple 0.6s linear;
                        pointer-events: none;
                    `;
                    
                    this.style.position = 'relative';
                    this.style.overflow = 'hidden';
                    this.appendChild(ripple);
                    
                    setTimeout(() => {
                        ripple.remove();
                    }, 600);
                });
            });
        }

        // Add CSS for ripple animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes ripple {
                to {
                    transform: scale(4);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Page navigation with enhanced transitions
        function showPage(pageId) {
            // Hide all pages with fade out
            document.querySelectorAll('.page').forEach(page => {
                if (!page.classList.contains('hidden')) {
                    page.style.opacity = '0';
                    page.style.transform = 'translateX(-20px)';
                    
                    setTimeout(() => {
                        page.classList.add('hidden');
                    }, 150);
                }
            });
            
            // Show selected page with fade in
            setTimeout(() => {
                const targetPage = document.getElementById(pageId);
                targetPage.classList.remove('hidden');
                
                // Force reflow
                targetPage.offsetHeight;
                
                targetPage.style.opacity = '1';
                targetPage.style.transform = 'translateX(0)';
                
                currentPage = pageId;
                
                // Scroll to top of the page
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // Floating buttons are always visible now - no need to show/hide
                
                // Update navigation with animation
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('text-secondary');
                    item.classList.add('text-gray-400');
                    item.style.transform = 'translateY(0)';
                });
                
                const activeNav = document.querySelector(`[data-page="${pageId}"]`);
                if (activeNav) {
                    activeNav.classList.remove('text-gray-400');
                    activeNav.classList.add('text-secondary');
                    activeNav.style.transform = 'translateY(-2px)';
                }
                
                // Page-specific tips removed
            }, 150);
        }

        // Global location tracking variables
        let locationWatchId = null;
        let locationAttempts = 0;
        let bestAccuracy = Infinity;
        let locationUpdateInterval = null;

        // Continuous location tracking system
        function startLocationTracking() {
            if (!navigator.geolocation) return;

            // Clear any existing tracking
            if (locationWatchId) {
                navigator.geolocation.clearWatch(locationWatchId);
            }
            if (locationUpdateInterval) {
                clearInterval(locationUpdateInterval);
            }

            // Start watching position with high accuracy
            locationWatchId = navigator.geolocation.watchPosition(
                (position) => {
                    const newAccuracy = position.coords.accuracy;
                    
                    // Update if this is more accurate or first reading
                    if (newAccuracy < bestAccuracy || !currentLocation) {
                        bestAccuracy = newAccuracy;
                        currentLocation = {
                            latitude: position.coords.latitude,
                            longitude: position.coords.longitude,
                            accuracy: position.coords.accuracy,
                            altitude: position.coords.altitude,
                            altitudeAccuracy: position.coords.altitudeAccuracy,
                            heading: position.coords.heading,
                            speed: position.coords.speed,
                            timestamp: position.timestamp
                        };
                        
                        updateLocationStatus(true);
                        updateLocationDisplay();
                        
                        // Show accuracy improvement
                        if (newAccuracy <= 10) {
                            showToast(`📍 High accuracy location: ${Math.round(newAccuracy)}m`, 'success', 2000);
                        } else if (newAccuracy <= 50) {
                            showToast(`📍 Good location accuracy: ${Math.round(newAccuracy)}m`, 'info', 1500);
                        }
                    }
                },
                (error) => {
                    handleLocationError(error);
                },
                {
                    enableHighAccuracy: true,
                    timeout: 20000,
                    maximumAge: 30000
                }
            );

            // Periodic location refresh for maximum accuracy
            locationUpdateInterval = setInterval(() => {
                if (currentLocation && currentLocation.accuracy > 20) {
                    // Try to get better accuracy
                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            if (position.coords.accuracy < currentLocation.accuracy) {
                                currentLocation = {
                                    latitude: position.coords.latitude,
                                    longitude: position.coords.longitude,
                                    accuracy: position.coords.accuracy,
                                    altitude: position.coords.altitude,
                                    altitudeAccuracy: position.coords.altitudeAccuracy,
                                    heading: position.coords.heading,
                                    speed: position.coords.speed,
                                    timestamp: position.timestamp
                                };
                                updateLocationDisplay();
                            }
                        },
                        () => {}, // Ignore errors in periodic updates
                        {
                            enableHighAccuracy: true,
                            timeout: 10000,
                            maximumAge: 0
                        }
                    );
                }
            }, 60000); // Check every minute
        }

        function handleLocationError(error) {
            let errorMessage = '';
            let showPopup = false;
            
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    errorMessage = '🚫 Location access denied. Please enable location in your browser settings.';
                    showPopup = true;
                    break;
                case error.POSITION_UNAVAILABLE:
                    errorMessage = '📍 Location unavailable. Please check your GPS settings.';
                    showPopup = true;
                    break;
                case error.TIMEOUT:
                    errorMessage = '⏱️ Location request timed out. Trying again...';
                    // Retry automatically
                    setTimeout(() => requestLocationPermission(), 2000);
                    break;
                default:
                    errorMessage = '❌ Location error occurred. Please try again.';
                    showPopup = true;
            }
            
            showToast(errorMessage, 'error', 4000);
            
            if (showPopup) {
                setTimeout(() => showLocationPopup(), 1000);
            }
        }

        function updateLocationDisplay() {
            if (currentLocation) {
                // Update location button to show accuracy
                const locationBtn = document.getElementById('locationBtn');
                const locationAccuracy = document.getElementById('locationAccuracy');
                
                if (locationBtn && currentLocation.accuracy) {
                    const accuracy = Math.round(currentLocation.accuracy);
                    locationBtn.title = `📍 Location Active - Accuracy: ${accuracy}m\nLat: ${currentLocation.latitude.toFixed(6)}\nLng: ${currentLocation.longitude.toFixed(6)}\nClick to refresh location`;
                    
                    // Show accuracy indicator
                    if (locationAccuracy) {
                        locationAccuracy.style.display = 'flex';
                        
                        // Update accuracy indicator based on precision
                        if (accuracy <= 10) {
                            locationAccuracy.className = 'absolute -bottom-1 -right-1 bg-green-500 text-white text-xs font-bold rounded-full w-4 h-4 flex items-center justify-center shadow-md';
                            locationAccuracy.innerHTML = '<i class="fas fa-check text-xs"></i>';
                            locationAccuracy.title = `Excellent accuracy: ${accuracy}m`;
                        } else if (accuracy <= 30) {
                            locationAccuracy.className = 'absolute -bottom-1 -right-1 bg-blue-500 text-white text-xs font-bold rounded-full w-4 h-4 flex items-center justify-center shadow-md';
                            locationAccuracy.innerHTML = '<i class="fas fa-signal text-xs"></i>';
                            locationAccuracy.title = `Good accuracy: ${accuracy}m`;
                        } else if (accuracy <= 100) {
                            locationAccuracy.className = 'absolute -bottom-1 -right-1 bg-yellow-500 text-white text-xs font-bold rounded-full w-4 h-4 flex items-center justify-center shadow-md';
                            locationAccuracy.innerHTML = '<i class="fas fa-exclamation text-xs"></i>';
                            locationAccuracy.title = `Fair accuracy: ${accuracy}m`;
                        } else {
                            locationAccuracy.className = 'absolute -bottom-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full w-4 h-4 flex items-center justify-center shadow-md';
                            locationAccuracy.innerHTML = '<i class="fas fa-times text-xs"></i>';
                            locationAccuracy.title = `Poor accuracy: ${accuracy}m`;
                        }
                    }
                    
                    // Change button color based on accuracy
                    if (accuracy <= 10) {
                        locationBtn.className = 'bg-green-500 text-white p-2 rounded-full hover:bg-green-600 transition-colors pulse-glow relative';
                    } else if (accuracy <= 30) {
                        locationBtn.className = 'bg-blue-500 text-white p-2 rounded-full hover:bg-blue-600 transition-colors relative';
                    } else if (accuracy <= 100) {
                        locationBtn.className = 'bg-yellow-500 text-white p-2 rounded-full hover:bg-yellow-600 transition-colors relative';
                    } else {
                        locationBtn.className = 'bg-orange-500 text-white p-2 rounded-full hover:bg-orange-600 transition-colors relative';
                    }
                }
            } else {
                // No location available
                const locationBtn = document.getElementById('locationBtn');
                const locationAccuracy = document.getElementById('locationAccuracy');
                
                if (locationBtn) {
                    locationBtn.className = 'bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition-colors relative';
                    locationBtn.title = '❌ Location not available - Click to enable';
                }
                
                if (locationAccuracy) {
                    locationAccuracy.style.display = 'none';
                }
            }
        }

        // Location functions
        function requestLocationPermission() {
            if (!navigator.geolocation) {
                showToast('Geolocation is not supported by this browser', 'error');
                return;
            }

            showToast('🔍 Requesting high-accuracy location...', 'info');
            locationAttempts++;
            
            // Multiple attempts for best accuracy
            const maxAttempts = 3;
            let attempts = 0;
            
            function attemptLocationCapture() {
                attempts++;
                
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const newLocation = {
                            latitude: position.coords.latitude,
                            longitude: position.coords.longitude,
                            accuracy: position.coords.accuracy,
                            altitude: position.coords.altitude,
                            altitudeAccuracy: position.coords.altitudeAccuracy,
                            heading: position.coords.heading,
                            speed: position.coords.speed,
                            timestamp: position.timestamp
                        };
                        
                        // Accept if good accuracy or max attempts reached
                        if (position.coords.accuracy <= 20 || attempts >= maxAttempts) {
                            currentLocation = newLocation;
                            bestAccuracy = position.coords.accuracy;
                            updateLocationStatus(true);
                            updateLocationDisplay();
                            closeLocationPopup();
                            
                            // Start continuous tracking
                            startLocationTracking();
                            
                            showToast(`✅ Location enabled! Accuracy: ${Math.round(position.coords.accuracy)}m`, 'success');
                        } else {
                            // Try again for better accuracy
                            showToast(`📍 Improving accuracy... (${Math.round(position.coords.accuracy)}m)`, 'info', 1000);
                            setTimeout(() => attemptLocationCapture(), 1500);
                        }
                    },
                    (error) => {
                        handleLocationError(error);
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 15000,
                        maximumAge: 0
                    }
                );
            }
            
            attemptLocationCapture();
        }

        function updateLocationStatus(enabled) {
            const locationBtn = document.getElementById('locationBtn');
            const checkoutStatus = document.getElementById('checkoutLocationStatus');
            const checkoutText = document.getElementById('checkoutLocationText');
            const bookingStatus = document.getElementById('bookingLocationStatus');
            const bookingText = document.getElementById('bookingLocationText');

            if (enabled) {
                // Update header button
                if (locationBtn) {
                    locationBtn.className = 'bg-green-500 text-white p-2 rounded-full hover:bg-green-600 transition-colors relative';
                }
                
                // Update checkout form
                if (checkoutStatus) {
                    checkoutStatus.className = 'bg-green-50 p-3 rounded-lg';
                    if (checkoutText) {
                        checkoutText.textContent = 'Location enabled - Will be shared for accurate delivery';
                        checkoutText.className = 'text-sm font-semibold text-green-800';
                    }
                }
                
                // Update booking forms
                if (bookingStatus) {
                    bookingStatus.className = 'bg-green-50 p-3 rounded-lg';
                    if (bookingText) {
                        bookingText.textContent = 'Location enabled - Will be shared for accurate service';
                        bookingText.className = 'text-sm font-semibold text-green-800';
                    }
                }
            } else {
                // Update header button
                if (locationBtn) {
                    locationBtn.className = 'bg-gray-500 text-white p-2 rounded-full hover:bg-gray-600 transition-colors relative';
                }
                
                // Update checkout form
                if (checkoutStatus) {
                    checkoutStatus.className = 'bg-blue-50 p-3 rounded-lg';
                    if (checkoutText) {
                        checkoutText.textContent = 'Location will be captured during order for accurate delivery';
                        checkoutText.className = 'text-sm font-semibold text-blue-800';
                    }
                }
                
                // Update booking forms
                if (bookingStatus) {
                    bookingStatus.className = 'bg-blue-50 p-3 rounded-lg';
                    if (bookingText) {
                        bookingText.textContent = 'Location will be captured during booking for accurate service';
                        bookingText.className = 'text-sm font-semibold text-blue-800';
                    }
                }
            }
        }

        function requestLocation() {
            requestLocationPermission();
        }

        function showLocationPopup() {
            const popup = document.getElementById('locationPopup');
            popup.classList.add('active');
            document.body.classList.add('modal-open');
        }

        function closeLocationPopup() {
            const popup = document.getElementById('locationPopup');
            popup.classList.add('closing');
            setTimeout(() => {
                popup.classList.remove('active', 'closing');
                popup.style.display = 'none';
                document.body.classList.remove('modal-open');
            }, 400);
        }

        // Search functionality
        function searchProducts(query) {
            const searchInput = document.getElementById('searchInput');
            const clearButton = document.getElementById('clearSearch');
            const searchResults = document.getElementById('searchResults');
            const grid = document.getElementById('productsGrid');
            
            // Show/hide clear button
            if (query.trim()) {
                clearButton.style.display = 'block';
            } else {
                clearButton.style.display = 'none';
                searchResults.style.display = 'none';
                // Show default category when search is empty
                const currentCategory = document.querySelector('.category-card.bg-secondary')?.getAttribute('data-category') || 'vegetables';
                showCategory(currentCategory);
                return;
            }
            
            // Search across all products
            const searchTerm = query.toLowerCase().trim();
            let allResults = [];
            let totalFound = 0;
            
            // Search in all categories
            for (const [categoryName, categoryProducts] of Object.entries(products)) {
                const matchingProducts = categoryProducts.filter(product => 
                    product.name.toLowerCase().includes(searchTerm) ||
                    categoryName.toLowerCase().includes(searchTerm)
                );
                
                if (matchingProducts.length > 0) {
                    allResults.push({
                        category: categoryName,
                        products: matchingProducts
                    });
                    totalFound += matchingProducts.length;
                }
            }
            
            // Update search results info
            if (totalFound > 0) {
                searchResults.textContent = `Found ${totalFound} product${totalFound > 1 ? 's' : ''} matching "${query}"`;
                searchResults.style.display = 'block';
                
                // Clear category selection
                document.querySelectorAll('.category-card').forEach(card => {
                    card.classList.remove('bg-secondary', 'text-white');
                    card.classList.add('bg-white');
                });
                
                // Display search results
                const allProducts = allResults.flatMap(result => result.products);
                displayProducts(allProducts);
            } else {
                searchResults.textContent = `No products found for "${query}"`;
                searchResults.style.display = 'block';
                grid.innerHTML = '<div class="col-span-2 text-center py-8 text-gray-500"><i class="fas fa-search text-4xl mb-2 opacity-50"></i><p>No products found</p><p class="text-sm">Try searching with different keywords</p></div>';
            }
        }
        
        function clearSearch() {
            const searchInput = document.getElementById('searchInput');
            const clearButton = document.getElementById('clearSearch');
            const searchResults = document.getElementById('searchResults');
            
            searchInput.value = '';
            clearButton.style.display = 'none';
            searchResults.style.display = 'none';
            
            // Show default category
            const currentCategory = document.querySelector('.category-card.bg-secondary')?.getAttribute('data-category') || 'vegetables';
            showCategory(currentCategory);
        }
        
        function displayProducts(productList) {
            const grid = document.getElementById('productsGrid');
            
            grid.innerHTML = productList.map(product => {
                const isInWishlist = wishlist.find(item => item.id === product.id);
                return `
                <div class="product-card bg-white rounded-xl p-3 shadow-md">
                    <img src="${product.image}" alt="${product.name}" class="w-full h-24 object-cover rounded-lg mb-2">
                    <h4 class="font-semibold text-sm text-accent">${product.name}</h4>
                    <p class="text-xs text-secondary mb-2">At today's price</p>
                    <div class="bg-gray-50 rounded-lg p-3 mt-2">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-xs font-semibold text-gray-700">Quantity</span>
                            <span class="text-xs text-secondary font-medium">Suggested: ${product.unit}</span>
                        </div>
                        <div class="flex items-center gap-2 mb-2">
                            <button onclick="decreaseQuantity(${product.id})" class="bg-white border border-gray-300 text-gray-700 w-8 h-8 rounded-lg text-sm font-bold hover:bg-gray-100 transition-colors shadow-sm">-</button>
                            <div class="flex-1 relative">
                                <input type="number" id="qty-${product.id}" value="1" min="0.1" max="999" step="0.1" 
                                       class="w-full text-center text-sm font-semibold border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent" 
                                       placeholder="Amount">
                                <div class="absolute inset-y-0 right-2 flex items-center pointer-events-none">
                                    <i class="fas fa-edit text-gray-400 text-xs"></i>
                                </div>
                            </div>
                            <button onclick="increaseQuantity(${product.id})" class="bg-white border border-gray-300 text-gray-700 w-8 h-8 rounded-lg text-sm font-bold hover:bg-gray-100 transition-colors shadow-sm">+</button>
                        </div>
                        <div class="mb-2">
                            <input type="text" id="unit-${product.id}" value="${product.unit}" 
                                   class="w-full text-center text-xs border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent bg-white" 
                                   placeholder="Unit (kg, grams, ml, pieces, etc.)">
                        </div>
                        <p class="text-xs text-gray-500 text-center">
                            <i class="fas fa-info-circle mr-1"></i>
                            Type any amount & unit (e.g., 500 grams, 2.5 kg, 10 pieces)
                        </p>
                    </div>
                    <div class="flex gap-2 mt-2">
                        <button onclick="addToWishlist(${product.id})" class="flex-1 ${isInWishlist ? 'bg-red-100 text-red-600' : 'bg-gray-100 text-gray-700'} p-2 rounded text-xs transition-colors">
                            <i class="fas fa-heart ${isInWishlist ? 'text-red-500' : ''}"></i>
                        </button>
                        <button onclick="addToCart(${product.id})" class="flex-1 bg-secondary text-white p-2 rounded text-xs hover:bg-opacity-90 transition-colors">
                            Add to Cart
                        </button>
                    </div>
                </div>
            `;
            }).join('');
        }

        // Store functions
        function showCategory(category) {
            // Update category selection
            document.querySelectorAll('.category-card').forEach(card => {
                card.classList.remove('bg-secondary', 'text-white');
                card.classList.add('bg-white');
            });
            
            const selectedCategory = document.querySelector(`[data-category="${category}"]`);
            if (selectedCategory) {
                selectedCategory.classList.remove('bg-white');
                selectedCategory.classList.add('bg-secondary', 'text-white');
            }
            
            const categoryProducts = products[category] || [];
            
            // Clear search when showing category
            const searchInput = document.getElementById('searchInput');
            const clearButton = document.getElementById('clearSearch');
            const searchResults = document.getElementById('searchResults');
            
            if (searchInput && searchInput.value.trim()) {
                searchInput.value = '';
                clearButton.style.display = 'none';
                searchResults.style.display = 'none';
            }
            
            displayProducts(categoryProducts);
        }

        function increaseQuantity(productId) {
            const input = document.getElementById(`qty-${productId}`);
            input.value = parseInt(input.value) + 1;
        }

        function decreaseQuantity(productId) {
            const input = document.getElementById(`qty-${productId}`);
            if (parseInt(input.value) > 1) {
                input.value = parseInt(input.value) - 1;
            }
        }

        function addToCart(productId) {
            const product = findProductById(productId);
            const quantityInput = document.getElementById(`qty-${productId}`);
            const unitInput = document.getElementById(`unit-${productId}`);
            const quantity = parseFloat(quantityInput.value);
            const unit = unitInput.value.trim() || product.unit;
            
            if (product && quantity > 0) {
                // Create display quantity - if quantity is 1 and unit is custom, show just the unit
                let displayQuantity;
                if (quantity === 1 && unit !== product.unit) {
                    displayQuantity = unit; // Show just "500grams" instead of "1 500grams"
                } else {
                    displayQuantity = `${quantity} ${unit}`; // Show "2 kg" or "1 kg"
                }
                
                const cartItem = { ...product, quantity, unit, displayQuantity };
                const existingItemIndex = cart.findIndex(item => item.id === productId && item.unit === unit);
                
                if (existingItemIndex !== -1) {
                    const existingItem = cart[existingItemIndex];
                    existingItem.quantity += quantity;
                    // Update display quantity for existing item
                    if (existingItem.quantity === 1 && existingItem.unit !== product.unit) {
                        existingItem.displayQuantity = existingItem.unit;
                    } else {
                        existingItem.displayQuantity = `${existingItem.quantity} ${existingItem.unit}`;
                    }
                } else {
                    cart.push(cartItem);
                }
                updateCartCount();
                showConfirmation('✅', 'Added to Cart!', `${product.name} (${displayQuantity}) added to your cart`);
                
                // Reset quantity to 1 but keep custom unit
                quantityInput.value = 1;
            }
        }

        function addToWishlist(productId) {
            const product = findProductById(productId);
            const existingItem = wishlist.find(item => item.id === productId);
            
            if (product) {
                if (existingItem) {
                    // Remove from wishlist
                    wishlist = wishlist.filter(item => item.id !== productId);
                    updateWishlistCount();
                    showConfirmation('💔', 'Removed from Wishlist', `${product.name} removed from your wishlist`);
                } else {
                    // Add to wishlist
                    wishlist.push(product);
                    updateWishlistCount();
                    showConfirmation('❤️', 'Added to Wishlist!', `${product.name} added to your wishlist`);
                }
                
                // Refresh the current category to update heart icons
                const currentCategory = document.querySelector('.category-card.bg-secondary')?.getAttribute('data-category') || 'vegetables';
                showCategory(currentCategory);
            }
        }

        function findProductById(id) {
            for (const category in products) {
                const product = products[category].find(p => p.id === id);
                if (product) return product;
            }
            return null;
        }

        function updateCartCount() {
            const count = cart.length;
            const cartCountElement = document.getElementById('cartCount');
            const headerCartCount = document.getElementById('headerCartCount');
            
            if (cartCountElement) {
                cartCountElement.textContent = count;
                if (count > 0) {
                    cartCountElement.style.display = 'flex';
                } else {
                    cartCountElement.style.display = 'none';
                }
            }
            
            if (headerCartCount) {
                headerCartCount.textContent = count;
            }
            
            // Show header cart button if cart has items
            const headerCartBtn = document.getElementById('headerCartBtn');
            if (headerCartBtn) {
                if (count > 0) {
                    headerCartBtn.style.display = 'block';
                } else {
                    headerCartBtn.style.display = 'none';
                }
            }
        }

        function updateWishlistCount() {
            const count = wishlist.length;
            const wishlistCountElement = document.getElementById('wishlistCount');
            const headerWishlistCount = document.getElementById('headerWishlistCount');
            
            if (wishlistCountElement) {
                wishlistCountElement.textContent = count;
                if (count > 0) {
                    wishlistCountElement.style.display = 'flex';
                } else {
                    wishlistCountElement.style.display = 'none';
                }
            }
            
            if (headerWishlistCount) {
                headerWishlistCount.textContent = count;
            }
            
            // Show header wishlist button if wishlist has items
            const headerWishlistBtn = document.getElementById('headerWishlistBtn');
            if (headerWishlistBtn) {
                if (count > 0) {
                    headerWishlistBtn.style.display = 'block';
                } else {
                    headerWishlistBtn.style.display = 'none';
                }
            }
        }

        function toggleCart() {
            const modal = document.getElementById('cartModal');
            const cartItems = document.getElementById('cartItems');
            
            if (modal.classList.contains('active')) {
                modal.classList.remove('active');
                document.body.classList.remove('modal-open');
            } else {
                cartItems.innerHTML = cart.map((item, index) => `
                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                        <img src="${item.image}" alt="${item.name}" class="w-12 h-12 object-cover rounded">
                        <div class="flex-1">
                            <h4 class="font-semibold text-sm">${item.name}</h4>
                            <p class="text-xs text-gray-600">${item.displayQuantity || `${item.quantity} ${item.unit}`}</p>
                        </div>
                        <button onclick="removeFromCart(${index})" class="text-red-500">
                            <i class="fas fa-trash text-sm"></i>
                        </button>
                    </div>
                `).join('');
                modal.classList.add('active');
                document.body.classList.add('modal-open');
            }
        }

        function toggleWishlist() {
            const modal = document.getElementById('wishlistModal');
            const wishlistItems = document.getElementById('wishlistItems');
            const wishlistEmpty = document.getElementById('wishlistEmpty');
            
            if (modal.classList.contains('active')) {
                modal.classList.remove('active');
                document.body.classList.remove('modal-open');
            } else {
                if (wishlist.length === 0) {
                    wishlistItems.innerHTML = '';
                    wishlistEmpty.style.display = 'block';
                } else {
                    wishlistEmpty.style.display = 'none';
                    wishlistItems.innerHTML = wishlist.map(item => `
                        <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                            <img src="${item.image}" alt="${item.name}" class="w-12 h-12 object-cover rounded">
                            <div class="flex-1">
                                <h4 class="font-semibold text-sm">${item.name}</h4>
                                <p class="text-xs text-gray-600">At today's price</p>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="moveToCart(${item.id})" class="bg-secondary text-white px-3 py-1 rounded text-xs">
                                    Add to Cart
                                </button>
                                <button onclick="removeFromWishlist(${item.id})" class="text-red-500">
                                    <i class="fas fa-trash text-sm"></i>
                                </button>
                            </div>
                        </div>
                    `).join('');
                }
                modal.classList.add('active');
                document.body.classList.add('modal-open');
            }
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartCount();
            toggleCart();
            toggleCart(); // Refresh cart display
        }

        function removeFromWishlist(productId) {
            const product = findProductById(productId);
            wishlist = wishlist.filter(item => item.id !== productId);
            updateWishlistCount();
            toggleWishlist();
            toggleWishlist(); // Refresh wishlist display
            
            if (product) {
                showConfirmation('💔', 'Removed from Wishlist', `${product.name} removed from your wishlist`);
            }
            
            // Refresh the current category to update heart icons
            if (currentPage === 'storePage') {
                const currentCategory = document.querySelector('.category-card.bg-secondary')?.getAttribute('data-category') || 'vegetables';
                showCategory(currentCategory);
            }
        }

        function moveToCart(productId) {
            const product = findProductById(productId);
            if (product) {
                // Add to cart with quantity 1 and default unit
                const unit = product.unit;
                const displayQuantity = `1 ${unit}`;
                const existingItem = cart.find(item => item.id === productId && item.unit === unit);
                
                if (existingItem) {
                    existingItem.quantity += 1;
                    existingItem.displayQuantity = `${existingItem.quantity} ${existingItem.unit}`;
                } else {
                    cart.push({ ...product, quantity: 1, unit, displayQuantity });
                }
                
                // Remove from wishlist
                wishlist = wishlist.filter(item => item.id !== productId);
                
                updateCartCount();
                updateWishlistCount();
                
                showConfirmation('🛒', 'Moved to Cart!', `${product.name} moved from wishlist to cart`);
                
                // Refresh wishlist display
                toggleWishlist();
                toggleWishlist();
                
                // Refresh the current category to update heart icons
                if (currentPage === 'storePage') {
                    const currentCategory = document.querySelector('.category-card.bg-secondary')?.getAttribute('data-category') || 'vegetables';
                    showCategory(currentCategory);
                }
            }
        }

        function proceedToCheckout() {
            if (cart.length === 0) {
                showToast('Your cart is empty!');
                return;
            }
            
            document.getElementById('cartModal').classList.remove('active');
            document.getElementById('checkoutModal').classList.add('active');
            document.body.classList.add('modal-open');
        }

        function closeCheckout() {
            document.getElementById('checkoutModal').classList.remove('active');
            document.body.classList.remove('modal-open');
        }

        // Checkout form submission
        document.getElementById('checkoutForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const customerData = {
                name: formData.get('customerName'),
                phone: formData.get('customerPhone'),
                address: formData.get('customerAddress')
            };

            // Validate form data
            if (!customerData.name || !customerData.phone || !customerData.address) {
                showToast('Please fill all required fields');
                return;
            }

            // Capture location during checkout and send WhatsApp order
            captureLocationForOrder('checkout', customerData);
        });

        function sendWhatsAppOrder(customerData, location) {
            // Get selected location phone number or default
            const phoneNumber = selectedLocationData ? selectedLocationData.number : '7799086877';
            const locationName = selectedLocationData ? selectedLocationData.name : 'Default Location';
            
            const orderDetails = cart.map(item => 
                `${item.name} - ${item.displayQuantity || `${item.quantity} ${item.unit}`}`
            ).join('\n');

            const currentDateTime = new Date();
            const timestamp = currentDateTime.toLocaleString('en-IN', {
                timeZone: 'Asia/Kolkata',
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            });

            let message = `*🛒 NEW ORDER - MANA DELIVERY*
*📍 Service Area: ${locationName}*

*📋 Customer Details:*
👤 Name: ${customerData.name}
📞 Phone: ${customerData.phone}
🏠 Address: ${customerData.address}

*🛍️ Order Items:*
${orderDetails}

*📊 Order Summary:*
Total Items: ${cart.length}
Order Time: ${timestamp}`;

            if (location) {
                message += `

*📍 PRECISE LOCATION DETAILS:*
🌐 Latitude: ${location.latitude.toFixed(8)}
🌐 Longitude: ${location.longitude.toFixed(8)}
🎯 Accuracy: ${location.accuracy ? Math.round(location.accuracy) + ' meters' : 'Not available'}
${location.altitude ? `🏔️ Altitude: ${Math.round(location.altitude)} meters` : ''}
${location.heading ? `🧭 Heading: ${Math.round(location.heading)}°` : ''}
${location.speed ? `⚡ Speed: ${Math.round(location.speed * 3.6)} km/h` : ''}
⏰ Location Captured: ${new Date(location.timestamp).toLocaleString('en-IN', { timeZone: 'Asia/Kolkata' })}

*🗺️ NAVIGATION LINKS:*
📱 Google Maps: https://maps.google.com/?q=${location.latitude},${location.longitude}
🚗 Directions: https://www.google.com/maps/dir//${location.latitude},${location.longitude}
📍 Share Location: https://maps.google.com/maps?q=${location.latitude},${location.longitude}&z=18`;
            } else {
                message += `

*⚠️ LOCATION STATUS:*
❌ Location sharing was declined by customer
📝 Please contact customer for address confirmation`;
            }

            message += `

*📝 Instructions:*
Please confirm availability and delivery time.
Contact customer for any clarifications.`;

            const whatsappUrl = `https://wa.me/91${phoneNumber}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank', 'noopener,noreferrer');
            
            // Clear cart and close modal
            cart = [];
            updateCartCount();
            closeCheckout();
            showToast(`Order sent via WhatsApp to ${locationName} office!`);
            
            // Reset form
            document.getElementById('checkoutForm').reset();
        }

        // Transport booking functions
        function bookTransport(type) {
            openBookingModal('transport', type, {
                title: `Book ${type.charAt(0).toUpperCase() + type.slice(1)}`,
                fields: [
                    { name: 'name', label: 'Full Name', type: 'text', required: true },
                    { name: 'phone', label: 'Phone Number', type: 'tel', required: true },
                    { name: 'pickup', label: 'Pickup Location', type: 'text', required: true },
                    { name: 'destination', label: 'Destination', type: 'text', required: true },
                    { name: 'date', label: 'Date', type: 'date', required: true },
                    { name: 'time', label: 'Time', type: 'time', required: true },
                    { name: 'passengers', label: 'Number of Passengers', type: 'number', min: 1, max: 8, required: true },
                    { name: 'notes', label: 'Additional Notes', type: 'textarea', required: false }
                ]
            });
        }

        function bookTour(destination) {
            openBookingModal('tour', destination, {
                title: `Book ${destination.charAt(0).toUpperCase() + destination.slice(1)} Tour`,
                fields: [
                    { name: 'name', label: 'Full Name', type: 'text', required: true },
                    { name: 'phone', label: 'Phone Number', type: 'tel', required: true },
                    { name: 'email', label: 'Email', type: 'email', required: false },
                    { name: 'date', label: 'Tour Date', type: 'date', required: true },
                    { name: 'people', label: 'Number of People', type: 'number', min: 1, max: 50, required: true },
                    { name: 'package', label: 'Package Type', type: 'select', options: ['Half Day', 'Full Day', 'Multi Day'], required: true },
                    { name: 'requirements', label: 'Special Requirements', type: 'textarea', required: false }
                ]
            });
        }

        // Service booking functions
        function bookService(service) {
            openBookingModal('service', service, {
                title: `Book ${service.charAt(0).toUpperCase() + service.slice(1)} Service`,
                fields: [
                    { name: 'name', label: 'Full Name', type: 'text', required: true },
                    { name: 'phone', label: 'Phone Number', type: 'tel', required: true },
                    { name: 'address', label: 'Service Address', type: 'textarea', required: true },
                    { name: 'date', label: 'Preferred Date', type: 'date', required: true },
                    { name: 'time', label: 'Preferred Time', type: 'time', required: true },
                    { name: 'urgency', label: 'Urgency', type: 'select', options: ['Normal', 'Urgent', 'Emergency'], required: true },
                    { name: 'description', label: 'Problem Description', type: 'textarea', required: true }
                ]
            });
        }

        function bookEvent(eventType) {
            openBookingModal('event', eventType, {
                title: `Plan ${eventType.charAt(0).toUpperCase() + eventType.slice(1)} Event`,
                fields: [
                    { name: 'name', label: 'Full Name', type: 'text', required: true },
                    { name: 'phone', label: 'Phone Number', type: 'tel', required: true },
                    { name: 'email', label: 'Email', type: 'email', required: true },
                    { name: 'eventDate', label: 'Event Date', type: 'date', required: true },
                    { name: 'venue', label: 'Preferred Venue', type: 'text', required: false },
                    { name: 'guests', label: 'Expected Guests', type: 'number', min: 10, max: 1000, required: true },
                    { name: 'budget', label: 'Budget Range', type: 'select', options: ['₹10,000 - ₹50,000', '₹50,000 - ₹1,00,000', '₹1,00,000 - ₹5,00,000', '₹5,00,000+'], required: true },
                    { name: 'requirements', label: 'Event Requirements', type: 'textarea', required: true }
                ]
            });
        }

        function requestService(serviceType) {
            openBookingModal('business', serviceType, {
                title: `Request ${serviceType.replace('-', ' ').toUpperCase()} Service`,
                fields: [
                    { name: 'businessName', label: 'Business Name', type: 'text', required: true },
                    { name: 'contactPerson', label: 'Contact Person', type: 'text', required: true },
                    { name: 'phone', label: 'Phone Number', type: 'tel', required: true },
                    { name: 'email', label: 'Email', type: 'email', required: true },
                    { name: 'businessType', label: 'Business Type', type: 'select', options: ['Restaurant', 'Retail Store', 'Service Provider', 'E-commerce', 'Other'], required: true },
                    { name: 'timeline', label: 'Project Timeline', type: 'select', options: ['1-2 weeks', '2-4 weeks', '1-2 months', '2+ months'], required: true },
                    { name: 'budget', label: 'Budget Range', type: 'select', options: ['₹5,000 - ₹25,000', '₹25,000 - ₹50,000', '₹50,000 - ₹1,00,000', '₹1,00,000+'], required: true },
                    { name: 'description', label: 'Project Description', type: 'textarea', required: true }
                ]
            });
        }

        function joinAs(role) {
            openBookingModal('join', role, {
                title: `Join as ${role.replace('-', ' ').toUpperCase()}`,
                fields: [
                    { name: 'fullName', label: 'Full Name', type: 'text', required: true },
                    { name: 'phone', label: 'Phone Number', type: 'tel', required: true },
                    { name: 'email', label: 'Email', type: 'email', required: true },
                    { name: 'age', label: 'Age', type: 'number', min: 18, max: 65, required: true },
                    { name: 'experience', label: 'Experience (years)', type: 'number', min: 0, max: 50, required: true },
                    { name: 'availability', label: 'Availability', type: 'select', options: ['Full Time', 'Part Time', 'Weekends Only', 'Flexible'], required: true },
                    { name: 'vehicle', label: 'Own Vehicle', type: 'select', options: ['Yes - Bike', 'Yes - Car', 'Yes - Both', 'No'], required: role === 'driver' || role === 'delivery-boy' },
                    { name: 'address', label: 'Current Address', type: 'textarea', required: true },
                    { name: 'motivation', label: 'Why do you want to join?', type: 'textarea', required: true }
                ]
            });
        }

        // Quick booking functions
        function openQuickTransport() {
            openBookingModal('quick-transport', 'local', {
                title: 'Quick Transport Booking',
                fields: [
                    { name: 'name', label: 'Your Name', type: 'text', required: true },
                    { name: 'phone', label: 'Phone Number', type: 'tel', required: true },
                    { name: 'pickup', label: 'Pickup Location', type: 'text', required: true },
                    { name: 'destination', label: 'Destination', type: 'text', required: true },
                    { name: 'vehicleType', label: 'Vehicle Type', type: 'select', options: ['Bike', 'Auto', 'Car', 'Any Available'], required: true },
                    { name: 'when', label: 'When', type: 'select', options: ['Now', 'In 30 minutes', 'In 1 hour', 'Schedule for later'], required: true }
                ]
            });
        }

        function openQuickHomeDelivery() {
            openBookingModal('quick-home-delivery', 'groceries', {
                title: 'Quick Home Delivery',
                fields: [
                    { name: 'name', label: 'Your Name', type: 'text', required: true },
                    { name: 'phone', label: 'Phone Number', type: 'tel', required: true },
                    { name: 'address', label: 'Delivery Address', type: 'textarea', required: true },
                    { name: 'deliveryType', label: 'What do you need?', type: 'radio', options: [
                        { value: 'vegetables', label: '🥕 Fresh Vegetables', description: 'Tomatoes, onions, leafy greens, etc.' },
                        { value: 'groceries', label: '🛒 Groceries & Essentials', description: 'Rice, oil, spices, household items' },
                        { value: 'fruits', label: '🍎 Fresh Fruits', description: 'Seasonal fruits, dry fruits' },
                        { value: 'dairy', label: '🥛 Dairy Products', description: 'Milk, yogurt, cheese, butter' },
                        { value: 'medicines', label: '💊 Medicines', description: 'Prescription & OTC medicines' },
                        { value: 'bakery', label: '🍞 Bakery Items', description: 'Bread, cakes, biscuits' },
                        { value: 'other', label: '📦 Other Items', description: 'Specify in requirements below' }
                    ], required: true },
                    { name: 'urgency', label: 'When do you need it?', type: 'select', options: ['Within 1 hour', 'Within 2 hours', 'Today evening', 'Tomorrow morning', 'No rush'], required: true },
                    { name: 'budget', label: 'Approximate Budget', type: 'select', options: ['₹100 - ₹500', '₹500 - ₹1,000', '₹1,000 - ₹2,000', '₹2,000+'], required: true },
                    { name: 'requirements', label: 'Specific Requirements', type: 'textarea', required: true, placeholder: 'List specific items you need (e.g., 1kg tomatoes, 2L milk, bread, etc.)' }
                ]
            });
        }

        function openQuickDelivery() {
            openBookingModal('quick-delivery', 'parcel', {
                title: 'Quick Parcel Delivery',
                fields: [
                    { name: 'senderName', label: 'Sender Name', type: 'text', required: true },
                    { name: 'senderPhone', label: 'Sender Phone', type: 'tel', required: true },
                    { name: 'receiverName', label: 'Receiver Name', type: 'text', required: true },
                    { name: 'receiverPhone', label: 'Receiver Phone', type: 'tel', required: true },
                    { name: 'pickupAddress', label: 'Pickup Address', type: 'textarea', required: true },
                    { name: 'deliveryAddress', label: 'Delivery Address', type: 'textarea', required: true },
                    { name: 'parcelType', label: 'Parcel Type', type: 'select', options: ['Documents', 'Food', 'Electronics', 'Clothes', 'Other'], required: true },
                    { name: 'weight', label: 'Approximate Weight', type: 'select', options: ['Under 1kg', '1-5kg', '5-10kg', '10kg+'], required: true },
                    { name: 'urgency', label: 'Delivery Urgency', type: 'select', options: ['Same Day', 'Next Day', 'Within 3 Days'], required: true }
                ]
            });
        }

        // Generic booking modal system
        function openBookingModal(type, subtype, config) {

            // Create modal HTML
            const modalHTML = `
                <div id="bookingModal" class="modal active">
                    <div class="bg-white rounded-xl p-6 m-4 max-w-md w-full max-h-[80vh] overflow-y-auto">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-bold text-accent">${config.title}</h3>
                            <button onclick="closeBookingModal()" class="text-gray-500">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="bookingForm" class="space-y-4">
                            ${config.fields.map(field => createFormField(field)).join('')}
                            <div id="bookingLocationStatus" class="bg-blue-50 p-3 rounded-lg">
                                <p class="text-sm font-semibold text-blue-800">
                                    <i class="fas fa-map-marker-alt mr-2"></i>
                                    <span id="bookingLocationText">Location will be captured during booking for accurate service</span>
                                </p>
                            </div>
                            <button type="submit" class="w-full bg-green-500 text-white p-3 rounded-lg font-semibold flex items-center justify-center gap-2">
                                <i class="fab fa-whatsapp"></i>
                                Send Request via WhatsApp
                            </button>
                        </form>
                    </div>
                </div>
            `;

            // Remove existing modal if any
            const existingModal = document.getElementById('bookingModal');
            if (existingModal) {
                existingModal.remove();
            }

            // Add modal to body
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            document.body.classList.add('modal-open');

            // Set minimum date to today for date fields
            const dateInputs = document.querySelectorAll('#bookingModal input[type="date"]');
            const today = new Date().toISOString().split('T')[0];
            dateInputs.forEach(input => {
                input.min = today;
            });

            // Update location status in the new form
            updateLocationStatus(!!currentLocation);

            // Add form submission handler
            document.getElementById('bookingForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleBookingSubmission(type, subtype, config, e.target);
            });
        }

        function createFormField(field) {
            let fieldHTML = `
                <div>
                    <label for="${field.name}" class="block text-sm font-semibold text-accent mb-1">
                        ${field.label}${field.required ? ' *' : ''}
                    </label>
            `;

            switch (field.type) {
                case 'select':
                    fieldHTML += `
                        <select id="${field.name}" name="${field.name}" ${field.required ? 'required' : ''} 
                                class="w-full p-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary">
                            <option value="">Select ${field.label}</option>
                            ${field.options.map(option => `<option value="${option}">${option}</option>`).join('')}
                        </select>
                    `;
                    break;
                case 'radio':
                    fieldHTML += `
                        <div class="space-y-3">
                            ${field.options.map((option, index) => `
                                <label class="flex items-start gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors">
                                    <input type="radio" name="${field.name}" value="${option.value}" ${field.required ? 'required' : ''} 
                                           class="mt-1 text-secondary focus:ring-secondary">
                                    <div class="flex-1">
                                        <div class="font-semibold text-sm text-accent">${option.label}</div>
                                        <div class="text-xs text-gray-600 mt-1">${option.description}</div>
                                    </div>
                                </label>
                            `).join('')}
                        </div>
                    `;
                    break;
                case 'textarea':
                    fieldHTML += `
                        <textarea id="${field.name}" name="${field.name}" ${field.required ? 'required' : ''} rows="3"
                                  class="w-full p-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary"
                                  placeholder="${field.placeholder || 'Enter ' + field.label.toLowerCase()}"></textarea>
                    `;
                    break;
                default:
                    fieldHTML += `
                        <input type="${field.type}" id="${field.name}" name="${field.name}" 
                               ${field.required ? 'required' : ''} 
                               ${field.min ? `min="${field.min}"` : ''}
                               ${field.max ? `max="${field.max}"` : ''}
                               class="w-full p-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary"
                               placeholder="${field.placeholder || 'Enter ' + field.label.toLowerCase()}">
                    `;
            }

            fieldHTML += '</div>';
            return fieldHTML;
        }

        function handleBookingSubmission(type, subtype, config, form) {
            const formData = new FormData(form);
            const data = {};
            
            // Collect form data
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }

            // Validate required fields
            const requiredFields = config.fields.filter(field => field.required);
            for (let field of requiredFields) {
                if (!data[field.name] || data[field.name].trim() === '') {
                    showToast(`Please fill in ${field.label}`);
                    return;
                }
            }

            // Capture location during booking and send WhatsApp booking
            captureLocationForOrder('booking', { type, subtype, data });
        }

        function sendBookingWhatsApp(type, subtype, data, location) {
            // Get selected location phone number or default
            const phoneNumber = selectedLocationData ? selectedLocationData.number : '7799086877';
            const locationName = selectedLocationData ? selectedLocationData.name : 'Default Location';
            
            const currentDateTime = new Date();
            const timestamp = currentDateTime.toLocaleString('en-IN', {
                timeZone: 'Asia/Kolkata',
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            });

            let message = `*🎯 ${type.toUpperCase()} BOOKING - MANA DELIVERY*
*📍 Service Area: ${locationName}*

*🔧 Service Type:* ${subtype.replace('-', ' ').toUpperCase()}

*📋 Customer Details:*`;
            
            // Add form data to message
            for (let [key, value] of Object.entries(data)) {
                if (value) {
                    const label = key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
                    message += `\n${getEmojiForField(key)} ${label}: ${value}`;
                }
            }

            message += `\n\n*⏰ Booking Time:* ${timestamp}`;

            if (location) {
                message += `

*📍 PRECISE LOCATION DETAILS:*
🌐 Latitude: ${location.latitude.toFixed(8)}
🌐 Longitude: ${location.longitude.toFixed(8)}
🎯 Accuracy: ${location.accuracy ? Math.round(location.accuracy) + ' meters' : 'Not available'}
${location.altitude ? `🏔️ Altitude: ${Math.round(location.altitude)} meters` : ''}
${location.heading ? `🧭 Heading: ${Math.round(location.heading)}°` : ''}
${location.speed ? `⚡ Speed: ${Math.round(location.speed * 3.6)} km/h` : ''}
⏰ Location Captured: ${new Date(location.timestamp).toLocaleString('en-IN', { timeZone: 'Asia/Kolkata' })}

*🗺️ NAVIGATION LINKS:*
📱 Google Maps: https://maps.google.com/?q=${location.latitude},${location.longitude}
🚗 Directions: https://www.google.com/maps/dir//${location.latitude},${location.longitude}
📍 Share Location: https://maps.google.com/maps?q=${location.latitude},${location.longitude}&z=18`;
            } else {
                message += `

*⚠️ LOCATION STATUS:*
❌ Location sharing was declined by customer
📝 Please contact customer for address confirmation`;
            }

            message += `

*📝 Instructions:*
Please confirm availability and provide quote.
Contact customer for service coordination.`;

            const whatsappUrl = `https://wa.me/91${phoneNumber}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank', 'noopener,noreferrer');
            
            closeBookingModal();
            showToast(`Booking request sent to ${locationName} office!`);
        }

        function getEmojiForField(fieldName) {
            const emojiMap = {
                name: '👤',
                phone: '📞',
                email: '📧',
                address: '🏠',
                pickup: '📍',
                destination: '🎯',
                date: '📅',
                time: '⏰',
                passengers: '👥',
                people: '👥',
                guests: '👥',
                budget: '💰',
                vehicle: '🚗',
                package: '📦',
                urgency: '⚡',
                description: '📝',
                requirements: '📝',
                notes: '📝'
            };
            return emojiMap[fieldName] || '•';
        }

        function closeBookingModal() {
            const modal = document.getElementById('bookingModal');
            if (modal) {
                modal.remove();
            }
            document.body.classList.remove('modal-open');
        }

        function captureLocationForOrder(actionType, actionData) {
            // Show location capture message
            showToast('📍 Capturing your location for accurate service...', 'info', 2000);
            
            if (!navigator.geolocation) {
                // No geolocation support - proceed without location
                showToast('⚠️ Location not supported - proceeding without location', 'warning');
                if (actionType === 'checkout') {
                    sendWhatsAppOrder(actionData, null);
                } else if (actionType === 'booking') {
                    sendBookingWhatsApp(actionData.type, actionData.subtype, actionData.data, null);
                }
                return;
            }

            // Enhanced location capture with multiple attempts
            let attempts = 0;
            const maxAttempts = 3;
            let bestLocation = currentLocation;
            let locationTimeout;
            
            function attemptLocationCapture() {
                attempts++;
                
                // Clear any existing timeout
                if (locationTimeout) {
                    clearTimeout(locationTimeout);
                }
                
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const newLocation = {
                            latitude: position.coords.latitude,
                            longitude: position.coords.longitude,
                            accuracy: position.coords.accuracy,
                            altitude: position.coords.altitude,
                            altitudeAccuracy: position.coords.altitudeAccuracy,
                            heading: position.coords.heading,
                            speed: position.coords.speed,
                            timestamp: position.timestamp
                        };
                        
                        // Keep the most accurate reading
                        if (!bestLocation || (newLocation.accuracy && newLocation.accuracy < bestLocation.accuracy)) {
                            bestLocation = newLocation;
                            currentLocation = bestLocation;
                            updateLocationStatus(true);
                            updateLocationDisplay();
                        }
                        
                        // Continue until we get good accuracy or max attempts
                        if (bestLocation.accuracy <= 20 || attempts >= maxAttempts) {
                            // Good accuracy or max attempts reached
                            showToast(`✅ Location captured with ${Math.round(bestLocation.accuracy)}m accuracy`, 'success', 1500);
                            if (actionType === 'checkout') {
                                sendWhatsAppOrder(actionData, bestLocation);
                            } else if (actionType === 'booking') {
                                sendBookingWhatsApp(actionData.type, actionData.subtype, actionData.data, bestLocation);
                            }
                        } else {
                            // Try again for better accuracy
                            showToast(`🔄 Improving location accuracy... ${attempts}/${maxAttempts}`, 'info', 1000);
                            locationTimeout = setTimeout(() => attemptLocationCapture(), 1500);
                        }
                    },
                    (error) => {
                        // Location error - proceed without location
                        console.log('Location capture failed:', error.message);
                        
                        if (bestLocation && bestLocation.latitude) {
                            // Use existing location if available
                            showToast('📍 Using previous location', 'info', 1500);
                            if (actionType === 'checkout') {
                                sendWhatsAppOrder(actionData, bestLocation);
                            } else if (actionType === 'booking') {
                                sendBookingWhatsApp(actionData.type, actionData.subtype, actionData.data, bestLocation);
                            }
                        } else {
                            // Proceed without location
                            showToast('⚠️ Location unavailable - proceeding without location', 'warning', 2000);
                            if (actionType === 'checkout') {
                                sendWhatsAppOrder(actionData, null);
                            } else if (actionType === 'booking') {
                                sendBookingWhatsApp(actionData.type, actionData.subtype, actionData.data, null);
                            }
                        }
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 30000
                    }
                );
            }
            
            // Start location capture
            attemptLocationCapture();
        }

        // Mandatory location popup functions removed - location is now optional



        // Confirmation popup functions
        function showConfirmation(icon, title, message) {
            const popup = document.getElementById('confirmationPopup');
            const iconElement = document.getElementById('confirmationIcon');
            const titleElement = document.getElementById('confirmationTitle');
            const messageElement = document.getElementById('confirmationMessage');
            
            iconElement.textContent = icon;
            titleElement.textContent = title;
            messageElement.textContent = message;
            
            popup.classList.add('active');
            document.body.classList.add('modal-open');
            
            // Auto close after 2 seconds
            setTimeout(() => {
                closeConfirmation();
            }, 2000);
        }

        function closeConfirmation() {
            const popup = document.getElementById('confirmationPopup');
            popup.classList.add('closing');
            setTimeout(() => {
                popup.classList.remove('active', 'closing');
                popup.style.display = 'none';
                document.body.classList.remove('modal-open');
            }, 400);
        }

        // Enhanced Utility functions
        function showToast(message, type = 'info', duration = 3000) {
            const toast = document.getElementById('toast');
            
            // Clear any existing timeout
            if (toast.timeoutId) {
                clearTimeout(toast.timeoutId);
            }
            
            // Set message and style based on type
            toast.textContent = message;
            toast.className = 'toast show';
            
            switch(type) {
                case 'success':
                    toast.style.background = '#10B981';
                    break;
                case 'error':
                    toast.style.background = '#EF4444';
                    break;
                case 'warning':
                    toast.style.background = '#F59E0B';
                    break;
                default:
                    toast.style.background = '#606C38';
            }
            
            // Add entrance animation
            toast.style.animation = 'toastSlideIn 0.3s ease-out';
            
            // Auto hide after duration
            toast.timeoutId = setTimeout(() => {
                toast.style.animation = 'toastSlideOut 0.3s ease-in';
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 300);
            }, duration);
        }

        // Add toast animations
        const toastStyle = document.createElement('style');
        toastStyle.textContent = `
            @keyframes toastSlideIn {
                from {
                    transform: translateX(100%) scale(0.8);
                    opacity: 0;
                }
                to {
                    transform: translateX(0) scale(1);
                    opacity: 1;
                }
            }
            
            @keyframes toastSlideOut {
                from {
                    transform: translateX(0) scale(1);
                    opacity: 1;
                }
                to {
                    transform: translateX(100%) scale(0.8);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(toastStyle);

        // Policy toggle functionality
        function togglePolicy(policyType) {
            const content = document.getElementById(`${policyType}-content`);
            const icon = document.getElementById(`${policyType}-icon`);
            
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                icon.style.transform = 'rotate(180deg)';
            } else {
                content.classList.add('hidden');
                icon.style.transform = 'rotate(0deg)';
            }
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9906196445e57ea4',t:'MTc2MDc3MDIwMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
